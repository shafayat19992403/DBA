Poisoned following participants: [1, 4, 7, 9]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0375, Accuracy: 124/600 (20.6667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0836, Accuracy: 1891/10000 (18.9100%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0376, Accuracy: 97/600 (16.1667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0811, Accuracy: 3235/10000 (32.3500%)
___Train Local_Simple,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0378, Accuracy: 87/600 (14.5000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1452, Accuracy: 4256/10000 (42.5600%)
___Train Local_Simple,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0377, Accuracy: 79/600 (13.1667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0869, Accuracy: 5154/10000 (51.5400%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0377, Accuracy: 142/600 (23.6667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1377, Accuracy: 2021/10000 (20.2100%)
___Train Local_Simple,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0377, Accuracy: 90/600 (15.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1151, Accuracy: 3853/10000 (38.5300%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0378, Accuracy: 75/600 (12.5000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1227, Accuracy: 4406/10000 (44.0600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0375, Accuracy: 80/600 (13.3333%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1615, Accuracy: 2731/10000 (27.3100%)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0377, Accuracy: 86/600 (14.3333%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1025, Accuracy: 2507/10000 (25.0700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0376, Accuracy: 101/600 (16.8333%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1502, Accuracy: 3244/10000 (32.4400%)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0376, Accuracy: 77/600 (12.8333%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1144, Accuracy: 2563/10000 (25.6300%)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0376, Accuracy: 120/600 (20.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0915, Accuracy: 3090/10000 (30.9000%)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0377, Accuracy: 97/600 (16.1667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1198, Accuracy: 2890/10000 (28.9000%)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0375, Accuracy: 94/600 (15.6667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0895, Accuracy: 2807/10000 (28.0700%)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0378, Accuracy: 95/600 (15.8333%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1132, Accuracy: 1523/10000 (15.2300%)
___Train Local_Simple,  epoch   1, local model 15, internal_epoch   1,  Average loss: 0.0376, Accuracy: 96/600 (16.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1797, Accuracy: 2727/10000 (27.2700%)
___Train Local_Simple,  epoch   1, local model 16, internal_epoch   1,  Average loss: 0.0376, Accuracy: 100/600 (16.6667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1050, Accuracy: 1175/10000 (11.7500%)
___Train Local_Simple,  epoch   1, local model 17, internal_epoch   1,  Average loss: 0.0377, Accuracy: 130/600 (21.6667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1509, Accuracy: 2207/10000 (22.0700%)
___Train Local_Simple,  epoch   1, local model 18, internal_epoch   1,  Average loss: 0.0376, Accuracy: 108/600 (18.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1024, Accuracy: 2073/10000 (20.7300%)
___Train Local_Simple,  epoch   1, local model 19, internal_epoch   1,  Average loss: 0.0376, Accuracy: 112/600 (18.6667%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1337, Accuracy: 1418/10000 (14.1800%)
time spent on training: 23.963189125061035
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2883, Accuracy: 1568/10000 (15.6800%)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2574, Accuracy: 718/8968 (8.0062%)
[Epoch 1] Backdoor Accuracy (combine): 718/8968 (8.01%)
Done in 33.636850118637085 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0369, Accuracy: 140/600 (23.3333%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8846, Accuracy: 4034/10000 (40.3400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0367, Accuracy: 171/600 (28.5000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9283, Accuracy: 4091/10000 (40.9100%)
___Train Local_Simple,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0371, Accuracy: 134/600 (22.3333%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9401, Accuracy: 4602/10000 (46.0200%)
___Train Local_Simple,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0369, Accuracy: 131/600 (21.8333%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9970, Accuracy: 2636/10000 (26.3600%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0370, Accuracy: 145/600 (24.1667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8932, Accuracy: 4134/10000 (41.3400%)
___Train Local_Simple,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0370, Accuracy: 118/600 (19.6667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9601, Accuracy: 3125/10000 (31.2500%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0372, Accuracy: 126/600 (21.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9294, Accuracy: 5236/10000 (52.3600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0369, Accuracy: 118/600 (19.6667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8802, Accuracy: 4702/10000 (47.0200%)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0370, Accuracy: 114/600 (19.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8643, Accuracy: 4066/10000 (40.6600%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0368, Accuracy: 129/600 (21.5000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8667, Accuracy: 4913/10000 (49.1300%)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0368, Accuracy: 112/600 (18.6667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8831, Accuracy: 3964/10000 (39.6400%)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0369, Accuracy: 124/600 (20.6667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8599, Accuracy: 4581/10000 (45.8100%)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0369, Accuracy: 144/600 (24.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9141, Accuracy: 3668/10000 (36.6800%)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0370, Accuracy: 120/600 (20.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9055, Accuracy: 3145/10000 (31.4500%)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0370, Accuracy: 145/600 (24.1667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9491, Accuracy: 5549/10000 (55.4900%)
___Train Local_Simple,  epoch   2, local model 15, internal_epoch   1,  Average loss: 0.0370, Accuracy: 109/600 (18.1667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9571, Accuracy: 2603/10000 (26.0300%)
___Train Local_Simple,  epoch   2, local model 16, internal_epoch   1,  Average loss: 0.0369, Accuracy: 144/600 (24.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9170, Accuracy: 4065/10000 (40.6500%)
___Train Local_Simple,  epoch   2, local model 17, internal_epoch   1,  Average loss: 0.0370, Accuracy: 184/600 (30.6667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9299, Accuracy: 4162/10000 (41.6200%)
___Train Local_Simple,  epoch   2, local model 18, internal_epoch   1,  Average loss: 0.0367, Accuracy: 133/600 (22.1667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8371, Accuracy: 4893/10000 (48.9300%)
___Train Local_Simple,  epoch   2, local model 19, internal_epoch   1,  Average loss: 0.0367, Accuracy: 158/600 (26.3333%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0656, Accuracy: 2836/10000 (28.3600%)
time spent on training: 34.6691038608551
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2669, Accuracy: 3340/10000 (33.4000%)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2577, Accuracy: 1245/8968 (13.8827%)
[Epoch 2] Backdoor Accuracy (combine): 1245/8968 (13.88%)
Done in 45.700385093688965 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0350, Accuracy: 210/600 (35.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.8901, Accuracy: 3302/10000 (33.0200%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0347, Accuracy: 214/600 (35.6667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.5953, Accuracy: 4353/10000 (43.5300%)
___Train Local_Simple,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0353, Accuracy: 202/600 (33.6667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6071, Accuracy: 4761/10000 (47.6100%)
___Train Local_Simple,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0346, Accuracy: 178/600 (29.6667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2563, Accuracy: 2736/10000 (27.3600%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0352, Accuracy: 208/600 (34.6667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2402, Accuracy: 2545/10000 (25.4500%)
___Train Local_Simple,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0355, Accuracy: 198/600 (33.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.7439, Accuracy: 3233/10000 (32.3300%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0353, Accuracy: 147/600 (24.5000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.8332, Accuracy: 4164/10000 (41.6400%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0345, Accuracy: 186/600 (31.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.6412, Accuracy: 2566/10000 (25.6600%)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0357, Accuracy: 170/600 (28.3333%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6991, Accuracy: 3144/10000 (31.4400%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0355, Accuracy: 168/600 (28.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.0631, Accuracy: 3640/10000 (36.4000%)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0350, Accuracy: 181/600 (30.1667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.9921, Accuracy: 3819/10000 (38.1900%)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0352, Accuracy: 202/600 (33.6667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.4443, Accuracy: 6048/10000 (60.4800%)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0350, Accuracy: 222/600 (37.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.3055, Accuracy: 3261/10000 (32.6100%)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0349, Accuracy: 163/600 (27.1667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.7998, Accuracy: 4465/10000 (44.6500%)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0353, Accuracy: 199/600 (33.1667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.1632, Accuracy: 2353/10000 (23.5300%)
___Train Local_Simple,  epoch   3, local model 15, internal_epoch   1,  Average loss: 0.0361, Accuracy: 175/600 (29.1667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6038, Accuracy: 4717/10000 (47.1700%)
___Train Local_Simple,  epoch   3, local model 16, internal_epoch   1,  Average loss: 0.0357, Accuracy: 173/600 (28.8333%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.7676, Accuracy: 3551/10000 (35.5100%)
___Train Local_Simple,  epoch   3, local model 17, internal_epoch   1,  Average loss: 0.0354, Accuracy: 221/600 (36.8333%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.4789, Accuracy: 5192/10000 (51.9200%)
___Train Local_Simple,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0357, Accuracy: 151/600 (25.1667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.8060, Accuracy: 3609/10000 (36.0900%)
___Train Local_Simple,  epoch   3, local model 19, internal_epoch   1,  Average loss: 0.0352, Accuracy: 154/600 (25.6667%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.9058, Accuracy: 2162/10000 (21.6200%)
time spent on training: 35.02941393852234
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2276, Accuracy: 4558/10000 (45.5800%)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2540, Accuracy: 1296/8968 (14.4514%)
[Epoch 3] Backdoor Accuracy (combine): 1296/8968 (14.45%)
Done in 45.23508310317993 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0326, Accuracy: 228/600 (38.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.6881, Accuracy: 3984/10000 (39.8400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0355, Accuracy: 231/600 (38.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.7707, Accuracy: 5125/10000 (51.2500%)
___Train Local_Simple,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0332, Accuracy: 180/600 (30.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.4116, Accuracy: 4507/10000 (45.0700%)
___Train Local_Simple,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0326, Accuracy: 206/600 (34.3333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.9377, Accuracy: 3840/10000 (38.4000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0331, Accuracy: 183/600 (30.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8428, Accuracy: 3439/10000 (34.3900%)
___Train Local_Simple,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0344, Accuracy: 188/600 (31.3333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.6461, Accuracy: 3210/10000 (32.1000%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0339, Accuracy: 213/600 (35.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.5051, Accuracy: 2404/10000 (24.0400%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0324, Accuracy: 249/600 (41.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1922, Accuracy: 5407/10000 (54.0700%)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0337, Accuracy: 261/600 (43.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.6246, Accuracy: 3607/10000 (36.0700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0331, Accuracy: 209/600 (34.8333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3259, Accuracy: 5266/10000 (52.6600%)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0325, Accuracy: 267/600 (44.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1963, Accuracy: 3530/10000 (35.3000%)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0321, Accuracy: 229/600 (38.1667%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 4.4430, Accuracy: 2053/10000 (20.5300%)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0328, Accuracy: 213/600 (35.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3070, Accuracy: 5796/10000 (57.9600%)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0338, Accuracy: 279/600 (46.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8638, Accuracy: 4682/10000 (46.8200%)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0330, Accuracy: 230/600 (38.3333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.9031, Accuracy: 3043/10000 (30.4300%)
___Train Local_Simple,  epoch   4, local model 15, internal_epoch   1,  Average loss: 0.0329, Accuracy: 229/600 (38.1667%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.0751, Accuracy: 6338/10000 (63.3800%)
___Train Local_Simple,  epoch   4, local model 16, internal_epoch   1,  Average loss: 0.0337, Accuracy: 259/600 (43.1667%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.7392, Accuracy: 3144/10000 (31.4400%)
___Train Local_Simple,  epoch   4, local model 17, internal_epoch   1,  Average loss: 0.0331, Accuracy: 233/600 (38.8333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3385, Accuracy: 5502/10000 (55.0200%)
___Train Local_Simple,  epoch   4, local model 18, internal_epoch   1,  Average loss: 0.0334, Accuracy: 234/600 (39.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3187, Accuracy: 5639/10000 (56.3900%)
___Train Local_Simple,  epoch   4, local model 19, internal_epoch   1,  Average loss: 0.0350, Accuracy: 189/600 (31.5000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8442, Accuracy: 3809/10000 (38.0900%)
time spent on training: 35.75131297111511
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.1628, Accuracy: 6060/10000 (60.6000%)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2559, Accuracy: 996/8968 (11.1062%)
[Epoch 4] Backdoor Accuracy (combine): 996/8968 (11.11%)
Done in 46.71252703666687 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0326, Accuracy: 267/600 (44.5000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.6773, Accuracy: 4564/10000 (45.6400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0302, Accuracy: 267/600 (44.5000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3251, Accuracy: 6309/10000 (63.0900%)
___Train Local_Simple,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0316, Accuracy: 259/600 (43.1667%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5778, Accuracy: 4690/10000 (46.9000%)
___Train Local_Simple,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0354, Accuracy: 307/600 (51.1667%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.0458, Accuracy: 4921/10000 (49.2100%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0332, Accuracy: 279/600 (46.5000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.8918, Accuracy: 3854/10000 (38.5400%)
___Train Local_Simple,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0360, Accuracy: 292/600 (48.6667%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.1059, Accuracy: 4133/10000 (41.3300%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0327, Accuracy: 276/600 (46.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.7603, Accuracy: 4083/10000 (40.8300%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0317, Accuracy: 271/600 (45.1667%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.6706, Accuracy: 4685/10000 (46.8500%)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0334, Accuracy: 264/600 (44.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.8385, Accuracy: 3818/10000 (38.1800%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0299, Accuracy: 296/600 (49.3333%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.1382, Accuracy: 5772/10000 (57.7200%)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0321, Accuracy: 269/600 (44.8333%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.6883, Accuracy: 4685/10000 (46.8500%)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0320, Accuracy: 252/600 (42.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5142, Accuracy: 6104/10000 (61.0400%)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0316, Accuracy: 265/600 (44.1667%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.7745, Accuracy: 4507/10000 (45.0700%)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0323, Accuracy: 255/600 (42.5000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.6759, Accuracy: 5546/10000 (55.4600%)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0362, Accuracy: 239/600 (39.8333%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.0737, Accuracy: 3878/10000 (38.7800%)
___Train Local_Simple,  epoch   5, local model 15, internal_epoch   1,  Average loss: 0.0340, Accuracy: 311/600 (51.8333%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.8501, Accuracy: 4824/10000 (48.2400%)
___Train Local_Simple,  epoch   5, local model 16, internal_epoch   1,  Average loss: 0.0313, Accuracy: 282/600 (47.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3023, Accuracy: 5913/10000 (59.1300%)
___Train Local_Simple,  epoch   5, local model 17, internal_epoch   1,  Average loss: 0.0310, Accuracy: 300/600 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3207, Accuracy: 5507/10000 (55.0700%)
___Train Local_Simple,  epoch   5, local model 18, internal_epoch   1,  Average loss: 0.0332, Accuracy: 239/600 (39.8333%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.8912, Accuracy: 4111/10000 (41.1100%)
___Train Local_Simple,  epoch   5, local model 19, internal_epoch   1,  Average loss: 0.0330, Accuracy: 279/600 (46.5000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.8121, Accuracy: 4701/10000 (47.0100%)
time spent on training: 33.851643085479736
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.1102, Accuracy: 6628/10000 (66.2800%)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.2882, Accuracy: 431/8968 (4.8060%)
[Epoch 5] Backdoor Accuracy (combine): 431/8968 (4.81%)
Done in 44.4219172000885 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0332, Accuracy: 286/600 (47.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.9379, Accuracy: 4367/10000 (43.6700%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0347, Accuracy: 271/600 (45.1667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.0455, Accuracy: 4632/10000 (46.3200%)
___Train Local_Simple,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0363, Accuracy: 232/600 (38.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.1086, Accuracy: 4415/10000 (44.1500%)
___Train Local_Simple,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0319, Accuracy: 316/600 (52.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.8358, Accuracy: 5103/10000 (51.0300%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0365, Accuracy: 276/600 (46.0000%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.1058, Accuracy: 3888/10000 (38.8800%)
___Train Local_Simple,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0362, Accuracy: 297/600 (49.5000%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.1385, Accuracy: 3021/10000 (30.2100%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0363, Accuracy: 294/600 (49.0000%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2176, Accuracy: 2763/10000 (27.6300%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0379, Accuracy: 281/600 (46.8333%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2535, Accuracy: 2106/10000 (21.0600%)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0386, Accuracy: 263/600 (43.8333%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2651, Accuracy: 1211/10000 (12.1100%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0436, Accuracy: 250/600 (41.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.3046, Accuracy: 985/10000 (9.8500%)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0348, Accuracy: 262/600 (43.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.0920, Accuracy: 2229/10000 (22.2900%)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0371, Accuracy: 274/600 (45.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2286, Accuracy: 2425/10000 (24.2500%)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0350, Accuracy: 275/600 (45.8333%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.0965, Accuracy: 4311/10000 (43.1100%)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0359, Accuracy: 313/600 (52.1667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.0801, Accuracy: 4728/10000 (47.2800%)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0354, Accuracy: 290/600 (48.3333%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.1319, Accuracy: 3430/10000 (34.3000%)
___Train Local_Simple,  epoch   6, local model 15, internal_epoch   1,  Average loss: 0.0356, Accuracy: 298/600 (49.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.0704, Accuracy: 3650/10000 (36.5000%)
___Train Local_Simple,  epoch   6, local model 16, internal_epoch   1,  Average loss: 0.0322, Accuracy: 306/600 (51.0000%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.6125, Accuracy: 4978/10000 (49.7800%)
___Train Local_Simple,  epoch   6, local model 17, internal_epoch   1,  Average loss: 0.0314, Accuracy: 292/600 (48.6667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.6505, Accuracy: 5464/10000 (54.6400%)
___Train Local_Simple,  epoch   6, local model 18, internal_epoch   1,  Average loss: 0.0334, Accuracy: 253/600 (42.1667%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.7627, Accuracy: 3986/10000 (39.8600%)
___Train Local_Simple,  epoch   6, local model 19, internal_epoch   1,  Average loss: 0.0331, Accuracy: 288/600 (48.0000%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.8538, Accuracy: 3844/10000 (38.4400%)
time spent on training: 35.254091024398804
Counter({np.int64(0): 18, np.int64(1): 2}) 2
[7, 8]
Removed Outlier's influence 7
Removed Outlier's influence 8
lengthof agents: 18
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.1642, Accuracy: 6230/10000 (62.3000%)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.2785, Accuracy: 727/8968 (8.1066%)
[Epoch 6] Backdoor Accuracy (combine): 727/8968 (8.11%)
Done in 45.71599006652832 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 7, 8].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0410, Accuracy: 300/600 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2801, Accuracy: 2088/10000 (20.8800%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0419, Accuracy: 279/600 (46.5000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2986, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0384, Accuracy: 293/600 (48.8333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2527, Accuracy: 3656/10000 (36.5600%)
___Train Local_Simple,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0396, Accuracy: 320/600 (53.3333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2728, Accuracy: 3704/10000 (37.0400%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0369, Accuracy: 310/600 (51.6667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.1432, Accuracy: 3439/10000 (34.3900%)
___Train Local_Simple,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0433, Accuracy: 302/600 (50.3333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3127, Accuracy: 1009/10000 (10.0900%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0374, Accuracy: 325/600 (54.1667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.1983, Accuracy: 3344/10000 (33.4400%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0392, Accuracy: 319/600 (53.1667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2753, Accuracy: 1610/10000 (16.1000%)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0424, Accuracy: 261/600 (43.5000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3149, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0353, Accuracy: 334/600 (55.6667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.1045, Accuracy: 3994/10000 (39.9400%)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0396, Accuracy: 245/600 (40.8333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2884, Accuracy: 1860/10000 (18.6000%)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0488, Accuracy: 269/600 (44.8333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3449, Accuracy: 982/10000 (9.8200%)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0430, Accuracy: 293/600 (48.8333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3324, Accuracy: 1884/10000 (18.8400%)
___Train Local_Simple,  epoch   7, local model 15, internal_epoch   1,  Average loss: 0.0427, Accuracy: 322/600 (53.6667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3060, Accuracy: 2192/10000 (21.9200%)
___Train Local_Simple,  epoch   7, local model 16, internal_epoch   1,  Average loss: 0.0397, Accuracy: 307/600 (51.1667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2981, Accuracy: 2846/10000 (28.4600%)
___Train Local_Simple,  epoch   7, local model 17, internal_epoch   1,  Average loss: 0.0392, Accuracy: 293/600 (48.8333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2732, Accuracy: 1864/10000 (18.6400%)
___Train Local_Simple,  epoch   7, local model 18, internal_epoch   1,  Average loss: 0.0403, Accuracy: 315/600 (52.5000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2760, Accuracy: 2150/10000 (21.5000%)
___Train Local_Simple,  epoch   7, local model 19, internal_epoch   1,  Average loss: 0.0351, Accuracy: 305/600 (50.8333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.1069, Accuracy: 3416/10000 (34.1600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0440, Accuracy: 280/600 (46.6667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3092, Accuracy: 1135/10000 (11.3500%)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0417, Accuracy: 302/600 (50.3333%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2871, Accuracy: 2458/10000 (24.5800%)
time spent on training: 30.844943046569824
Counter({np.int64(0): 17, np.int64(1): 3}) 2
[10, 13, 14]
Removed Outlier's influence 10
Removed Outlier's influence 13
Removed Outlier's influence 14
lengthof agents: 17
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.2218, Accuracy: 5051/10000 (50.5100%)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.2953, Accuracy: 242/8968 (2.6985%)
[Epoch 7] Backdoor Accuracy (combine): 242/8968 (2.70%)
Done in 40.31498599052429 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0397, Accuracy: 345/600 (57.5000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.1393, Accuracy: 2516/10000 (25.1600%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0365, Accuracy: 313/600 (52.1667%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2310, Accuracy: 3384/10000 (33.8400%)
___Train Local_Simple,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0390, Accuracy: 332/600 (55.3333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.6431, Accuracy: 1827/10000 (18.2700%)
___Train Local_Simple,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0372, Accuracy: 323/600 (53.8333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.3096, Accuracy: 3191/10000 (31.9100%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0407, Accuracy: 276/600 (46.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.1201, Accuracy: 2179/10000 (21.7900%)
___Train Local_Simple,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0370, Accuracy: 310/600 (51.6667%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.1230, Accuracy: 3309/10000 (33.0900%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0343, Accuracy: 332/600 (55.3333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5225, Accuracy: 4592/10000 (45.9200%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0366, Accuracy: 308/600 (51.3333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2886, Accuracy: 3464/10000 (34.6400%)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0369, Accuracy: 331/600 (55.1667%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2748, Accuracy: 4249/10000 (42.4900%)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0371, Accuracy: 326/600 (54.3333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.3601, Accuracy: 2970/10000 (29.7000%)
___Train Local_Simple,  epoch   8, local model 15, internal_epoch   1,  Average loss: 0.0328, Accuracy: 339/600 (56.5000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 7.5961, Accuracy: 1599/10000 (15.9900%)
___Train Local_Simple,  epoch   8, local model 16, internal_epoch   1,  Average loss: 0.0352, Accuracy: 313/600 (52.1667%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.4360, Accuracy: 2878/10000 (28.7800%)
___Train Local_Simple,  epoch   8, local model 17, internal_epoch   1,  Average loss: 0.0389, Accuracy: 318/600 (53.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.0822, Accuracy: 5208/10000 (52.0800%)
___Train Local_Simple,  epoch   8, local model 18, internal_epoch   1,  Average loss: 0.0343, Accuracy: 319/600 (53.1667%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.3815, Accuracy: 1362/10000 (13.6200%)
___Train Local_Simple,  epoch   8, local model 19, internal_epoch   1,  Average loss: 0.0405, Accuracy: 342/600 (57.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.9289, Accuracy: 2412/10000 (24.1200%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0380, Accuracy: 363/600 (60.5000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.8890, Accuracy: 4129/10000 (41.2900%)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0325, Accuracy: 340/600 (56.6667%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.8769, Accuracy: 4532/10000 (45.3200%)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0412, Accuracy: 345/600 (57.5000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.9979, Accuracy: 3770/10000 (37.7000%)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0332, Accuracy: 324/600 (54.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.6584, Accuracy: 2746/10000 (27.4600%)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0441, Accuracy: 290/600 (48.3333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.3014, Accuracy: 1032/10000 (10.3200%)
time spent on training: 31.990299224853516
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.1841, Accuracy: 5813/10000 (58.1300%)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.2979, Accuracy: 414/8968 (4.6164%)
[Epoch 8] Backdoor Accuracy (combine): 414/8968 (4.62%)
Done in 41.987075090408325 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0353, Accuracy: 345/600 (57.5000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.8042, Accuracy: 4366/10000 (43.6600%)
poison local model 1 index 0 
___Train Local_Simple,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0334, Accuracy: 329/600 (54.8333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.0230, Accuracy: 5165/10000 (51.6500%)
___Train Local_Simple,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0402, Accuracy: 310/600 (51.6667%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2470, Accuracy: 2574/10000 (25.7400%)
___Train Local_Simple,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0361, Accuracy: 354/600 (59.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2723, Accuracy: 2478/10000 (24.7800%)
poison local model 4 index 1 
___Train Local_Simple,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0366, Accuracy: 304/600 (50.6667%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.7878, Accuracy: 4413/10000 (44.1300%)
___Train Local_Simple,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0344, Accuracy: 342/600 (57.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.9026, Accuracy: 3270/10000 (32.7000%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0422, Accuracy: 330/600 (55.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.4716, Accuracy: 3477/10000 (34.7700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0323, Accuracy: 335/600 (55.8333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.6042, Accuracy: 4883/10000 (48.8300%)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0342, Accuracy: 322/600 (53.6667%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.8610, Accuracy: 5322/10000 (53.2200%)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0396, Accuracy: 317/600 (52.8333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1976, Accuracy: 3619/10000 (36.1900%)
___Train Local_Simple,  epoch   9, local model 15, internal_epoch   1,  Average loss: 0.0414, Accuracy: 304/600 (50.6667%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2625, Accuracy: 3751/10000 (37.5100%)
___Train Local_Simple,  epoch   9, local model 16, internal_epoch   1,  Average loss: 0.0421, Accuracy: 340/600 (56.6667%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1808, Accuracy: 4480/10000 (44.8000%)
___Train Local_Simple,  epoch   9, local model 17, internal_epoch   1,  Average loss: 0.0393, Accuracy: 323/600 (53.8333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.3298, Accuracy: 3829/10000 (38.2900%)
___Train Local_Simple,  epoch   9, local model 18, internal_epoch   1,  Average loss: 0.0351, Accuracy: 322/600 (53.6667%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.8115, Accuracy: 5542/10000 (55.4200%)
___Train Local_Simple,  epoch   9, local model 19, internal_epoch   1,  Average loss: 0.0339, Accuracy: 293/600 (48.8333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.9554, Accuracy: 3065/10000 (30.6500%)
poison local model 7 index 2 
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0325, Accuracy: 341/600 (56.8333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.7037, Accuracy: 4016/10000 (40.1600%)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0341, Accuracy: 342/600 (57.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.6259, Accuracy: 4237/10000 (42.3700%)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0402, Accuracy: 342/600 (57.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1427, Accuracy: 4354/10000 (43.5400%)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0332, Accuracy: 320/600 (53.3333%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.7904, Accuracy: 4086/10000 (40.8600%)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0398, Accuracy: 333/600 (55.5000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.0987, Accuracy: 3034/10000 (30.3400%)
time spent on training: 31.953360080718994
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.1578, Accuracy: 5605/10000 (56.0500%)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 2.3018, Accuracy: 379/8968 (4.2261%)
[Epoch 9] Backdoor Accuracy (combine): 379/8968 (4.23%)
Done in 41.560548067092896 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 0.0297, Accuracy: 353/600 (58.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.7829, Accuracy: 5505/10000 (55.0500%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0312, Accuracy: 340/600 (56.6667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0973, Accuracy: 4354/10000 (43.5400%)
___Train Local_Simple,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0368, Accuracy: 338/600 (56.3333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.2414, Accuracy: 1664/10000 (16.6400%)
___Train Local_Simple,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0313, Accuracy: 360/600 (60.0000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.6434, Accuracy: 5560/10000 (55.6000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0297, Accuracy: 315/600 (52.5000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.6514, Accuracy: 5255/10000 (52.5500%)
___Train Local_Simple,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0299, Accuracy: 326/600 (54.3333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.6875, Accuracy: 5374/10000 (53.7400%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0357, Accuracy: 328/600 (54.6667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.7662, Accuracy: 4067/10000 (40.6700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0324, Accuracy: 351/600 (58.5000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0917, Accuracy: 4506/10000 (45.0600%)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0338, Accuracy: 337/600 (56.1667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.4258, Accuracy: 2098/10000 (20.9800%)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0294, Accuracy: 315/600 (52.5000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.4395, Accuracy: 5518/10000 (55.1800%)
___Train Local_Simple,  epoch  10, local model 15, internal_epoch   1,  Average loss: 0.0327, Accuracy: 341/600 (56.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.9049, Accuracy: 4132/10000 (41.3200%)
___Train Local_Simple,  epoch  10, local model 16, internal_epoch   1,  Average loss: 0.0321, Accuracy: 347/600 (57.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.3602, Accuracy: 5616/10000 (56.1600%)
___Train Local_Simple,  epoch  10, local model 17, internal_epoch   1,  Average loss: 0.0381, Accuracy: 325/600 (54.1667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.1795, Accuracy: 5466/10000 (54.6600%)
___Train Local_Simple,  epoch  10, local model 18, internal_epoch   1,  Average loss: 0.0375, Accuracy: 304/600 (50.6667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0865, Accuracy: 3799/10000 (37.9900%)
___Train Local_Simple,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0386, Accuracy: 305/600 (50.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0447, Accuracy: 3583/10000 (35.8300%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0343, Accuracy: 343/600 (57.1667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.8606, Accuracy: 5268/10000 (52.6800%)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0342, Accuracy: 311/600 (51.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.1885, Accuracy: 4790/10000 (47.9000%)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0398, Accuracy: 335/600 (55.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.2415, Accuracy: 3865/10000 (38.6500%)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0290, Accuracy: 328/600 (54.6667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.6618, Accuracy: 5276/10000 (52.7600%)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0358, Accuracy: 325/600 (54.1667%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.7719, Accuracy: 6091/10000 (60.9100%)
time spent on training: 29.70617175102234
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.1073, Accuracy: 5669/10000 (56.6900%)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 2.3213, Accuracy: 178/8968 (1.9848%)
[Epoch 10] Backdoor Accuracy (combine): 178/8968 (1.98%)
Done in 39.44684290885925 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 0.0308, Accuracy: 333/600 (55.5000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.4091, Accuracy: 6204/10000 (62.0400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0274, Accuracy: 333/600 (55.5000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2177, Accuracy: 6729/10000 (67.2900%)
___Train Local_Simple,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0331, Accuracy: 326/600 (54.3333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.6821, Accuracy: 5344/10000 (53.4400%)
___Train Local_Simple,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0334, Accuracy: 326/600 (54.3333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.8698, Accuracy: 6011/10000 (60.1100%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0280, Accuracy: 322/600 (53.6667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.4233, Accuracy: 5672/10000 (56.7200%)
___Train Local_Simple,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0322, Accuracy: 323/600 (53.8333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.7059, Accuracy: 4301/10000 (43.0100%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0291, Accuracy: 348/600 (58.0000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.5451, Accuracy: 6373/10000 (63.7300%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0302, Accuracy: 346/600 (57.6667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.5422, Accuracy: 5080/10000 (50.8000%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0247, Accuracy: 354/600 (59.0000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.6598, Accuracy: 5618/10000 (56.1800%)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0285, Accuracy: 346/600 (57.6667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2717, Accuracy: 5289/10000 (52.8900%)
___Train Local_Simple,  epoch  11, local model 15, internal_epoch   1,  Average loss: 0.0276, Accuracy: 344/600 (57.3333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.1451, Accuracy: 6356/10000 (63.5600%)
___Train Local_Simple,  epoch  11, local model 16, internal_epoch   1,  Average loss: 0.0322, Accuracy: 341/600 (56.8333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.7660, Accuracy: 5746/10000 (57.4600%)
___Train Local_Simple,  epoch  11, local model 17, internal_epoch   1,  Average loss: 0.0301, Accuracy: 327/600 (54.5000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.4637, Accuracy: 6357/10000 (63.5700%)
___Train Local_Simple,  epoch  11, local model 18, internal_epoch   1,  Average loss: 0.0304, Accuracy: 340/600 (56.6667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.4434, Accuracy: 4952/10000 (49.5200%)
___Train Local_Simple,  epoch  11, local model 19, internal_epoch   1,  Average loss: 0.0305, Accuracy: 321/600 (53.5000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.2405, Accuracy: 3326/10000 (33.2600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0328, Accuracy: 346/600 (57.6667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.6407, Accuracy: 5930/10000 (59.3000%)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0274, Accuracy: 343/600 (57.1667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.9474, Accuracy: 4246/10000 (42.4600%)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0295, Accuracy: 362/600 (60.3333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3268, Accuracy: 5967/10000 (59.6700%)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0270, Accuracy: 355/600 (59.1667%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.6584, Accuracy: 4959/10000 (49.5900%)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0258, Accuracy: 338/600 (56.3333%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0144, Accuracy: 6721/10000 (67.2100%)
time spent on training: 30.234108924865723
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 2.0324, Accuracy: 6075/10000 (60.7500%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 2.3287, Accuracy: 192/8968 (2.1409%)
[Epoch 11] Backdoor Accuracy (combine): 192/8968 (2.14%)
Done in 40.19016480445862 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.0266, Accuracy: 340/600 (56.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1919, Accuracy: 6433/10000 (64.3300%)
poison local model 1 index 0 
poison_now
/Users/shafayat/miniforge3/envs/torch_env/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:595: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  _warn_get_lr_called_within_step(self)
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0300, Accuracy: 267/600 (44.5000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   2,  Average loss: 0.0218, Accuracy: 269/600 (44.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   3,  Average loss: 0.0201, Accuracy: 287/600 (47.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   4,  Average loss: 0.0178, Accuracy: 344/600 (57.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   5,  Average loss: 0.0167, Accuracy: 285/600 (47.5000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   6,  Average loss: 0.0157, Accuracy: 353/600 (58.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   7,  Average loss: 0.0161, Accuracy: 324/600 (54.0000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   8,  Average loss: 0.0147, Accuracy: 346/600 (57.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   9,  Average loss: 0.0150, Accuracy: 370/600 (61.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch  10,  Average loss: 0.0150, Accuracy: 344/600 (57.3333%), train_poison_data_count: 200
Global model norm: 14.062323132568304.
Norm before scaling: 14.480312267329563. Distance: 2.5668795307454744
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8765, Accuracy: 6247/10000 (62.4700%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.9825, Accuracy: 4011/8968 (44.7257%)
Scaling by  200
Scaled Norm after poisoning: 514.6074960588895, distance: 513.3759282923187
Total norm for 4 adversaries is: 514.6074960588895. distance: 513.3759282923187
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 11818275.6182, Accuracy: 7887/8968 (87.9460%)
___Train Local_Simple,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0268, Accuracy: 352/600 (58.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0935, Accuracy: 6946/10000 (69.4600%)
___Train Local_Simple,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0235, Accuracy: 374/600 (62.3333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9647, Accuracy: 6900/10000 (69.0000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0312, Accuracy: 343/600 (57.1667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4887, Accuracy: 6123/10000 (61.2300%)
___Train Local_Simple,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0274, Accuracy: 352/600 (58.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3180, Accuracy: 6226/10000 (62.2600%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0289, Accuracy: 363/600 (60.5000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3033, Accuracy: 6282/10000 (62.8200%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0254, Accuracy: 388/600 (64.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1011, Accuracy: 5972/10000 (59.7200%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0241, Accuracy: 366/600 (61.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0436, Accuracy: 6878/10000 (68.7800%)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0246, Accuracy: 362/600 (60.3333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0969, Accuracy: 6927/10000 (69.2700%)
___Train Local_Simple,  epoch  12, local model 15, internal_epoch   1,  Average loss: 0.0277, Accuracy: 340/600 (56.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2692, Accuracy: 6640/10000 (66.4000%)
___Train Local_Simple,  epoch  12, local model 16, internal_epoch   1,  Average loss: 0.0243, Accuracy: 374/600 (62.3333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3293, Accuracy: 5974/10000 (59.7400%)
___Train Local_Simple,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0261, Accuracy: 365/600 (60.8333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0130, Accuracy: 6870/10000 (68.7000%)
___Train Local_Simple,  epoch  12, local model 18, internal_epoch   1,  Average loss: 0.0257, Accuracy: 352/600 (58.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0201, Accuracy: 6776/10000 (67.7600%)
___Train Local_Simple,  epoch  12, local model 19, internal_epoch   1,  Average loss: 0.0265, Accuracy: 342/600 (57.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1307, Accuracy: 6224/10000 (62.2400%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0278, Accuracy: 374/600 (62.3333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3622, Accuracy: 6048/10000 (60.4800%)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0251, Accuracy: 362/600 (60.3333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1239, Accuracy: 5846/10000 (58.4600%)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0242, Accuracy: 383/600 (63.8333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.3869, Accuracy: 4859/10000 (48.5900%)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0277, Accuracy: 329/600 (54.8333%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2669, Accuracy: 5437/10000 (54.3700%)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0265, Accuracy: 354/600 (59.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.2755, Accuracy: 4617/10000 (46.1700%)
time spent on training: 36.140381813049316
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[1]
Removed Outlier's influence 1
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.9357, Accuracy: 6339/10000 (63.3900%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 2.3440, Accuracy: 171/8968 (1.9068%)
[Epoch 12] Backdoor Accuracy (combine): 171/8968 (1.91%)
Done in 45.88378882408142 sec.
Server Epoch:13 choose agents : [0, 2, 3, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14, 1].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.0265, Accuracy: 351/600 (58.5000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4013, Accuracy: 5243/10000 (52.4300%)
___Train Local_Simple,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0251, Accuracy: 342/600 (57.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1075, Accuracy: 6969/10000 (69.6900%)
___Train Local_Simple,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0358, Accuracy: 320/600 (53.3333%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.2762, Accuracy: 970/10000 (9.7000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0296, Accuracy: 333/600 (55.5000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.7492, Accuracy: 5881/10000 (58.8100%)
___Train Local_Simple,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0244, Accuracy: 361/600 (60.1667%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0680, Accuracy: 6973/10000 (69.7300%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0262, Accuracy: 363/600 (60.5000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1070, Accuracy: 7109/10000 (71.0900%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0268, Accuracy: 359/600 (59.8333%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.3460, Accuracy: 7138/10000 (71.3800%)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0262, Accuracy: 362/600 (60.3333%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2999, Accuracy: 6052/10000 (60.5200%)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0226, Accuracy: 361/600 (60.1667%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9136, Accuracy: 6672/10000 (66.7200%)
___Train Local_Simple,  epoch  13, local model 15, internal_epoch   1,  Average loss: 0.0246, Accuracy: 372/600 (62.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1141, Accuracy: 7152/10000 (71.5200%)
___Train Local_Simple,  epoch  13, local model 16, internal_epoch   1,  Average loss: 0.0238, Accuracy: 372/600 (62.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2718, Accuracy: 4807/10000 (48.0700%)
___Train Local_Simple,  epoch  13, local model 17, internal_epoch   1,  Average loss: 0.0238, Accuracy: 385/600 (64.1667%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2806, Accuracy: 6290/10000 (62.9000%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   1,  Average loss: 0.0248, Accuracy: 367/600 (61.1667%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1542, Accuracy: 5162/10000 (51.6200%)
___Train Local_Simple,  epoch  13, local model 19, internal_epoch   1,  Average loss: 0.0249, Accuracy: 379/600 (63.1667%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1916, Accuracy: 6333/10000 (63.3300%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0241, Accuracy: 390/600 (65.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1709, Accuracy: 6140/10000 (61.4000%)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0222, Accuracy: 366/600 (61.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.4258, Accuracy: 4467/10000 (44.6700%)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0273, Accuracy: 357/600 (59.5000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.5119, Accuracy: 6727/10000 (67.2700%)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0266, Accuracy: 377/600 (62.8333%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1584, Accuracy: 6112/10000 (61.1200%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0261, Accuracy: 357/600 (59.5000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1126, Accuracy: 6520/10000 (65.2000%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0246, Accuracy: 358/600 (59.6667%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2475, Accuracy: 6232/10000 (62.3200%)
time spent on training: 31.956549882888794
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[3]
Removed Outlier's influence 3
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.8544, Accuracy: 6499/10000 (64.9900%)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 2.3457, Accuracy: 214/8968 (2.3863%)
[Epoch 13] Backdoor Accuracy (combine): 214/8968 (2.39%)
Done in 42.65965700149536 sec.
Server Epoch:14 choose agents : [0, 2, 4, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14, 1, 3].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.0242, Accuracy: 369/600 (61.5000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2806, Accuracy: 6000/10000 (60.0000%)
___Train Local_Simple,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0226, Accuracy: 362/600 (60.3333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9387, Accuracy: 7143/10000 (71.4300%)
poison local model 4 index 1 
poison_now
/Users/shafayat/miniforge3/envs/torch_env/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:595: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  _warn_get_lr_called_within_step(self)
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0275, Accuracy: 275/600 (45.8333%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   2,  Average loss: 0.0190, Accuracy: 318/600 (53.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   3,  Average loss: 0.0194, Accuracy: 297/600 (49.5000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   4,  Average loss: 0.0156, Accuracy: 355/600 (59.1667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   5,  Average loss: 0.0158, Accuracy: 308/600 (51.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   6,  Average loss: 0.0152, Accuracy: 332/600 (55.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   7,  Average loss: 0.0143, Accuracy: 338/600 (56.3333%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   8,  Average loss: 0.0149, Accuracy: 320/600 (53.3333%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   9,  Average loss: 0.0139, Accuracy: 358/600 (59.6667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch  10,  Average loss: 0.0138, Accuracy: 369/600 (61.5000%), train_poison_data_count: 200
Global model norm: 14.121521107814042.
Norm before scaling: 14.536637946012052. Distance: 2.425973291827157
will scale.
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7873, Accuracy: 7000/10000 (70.0000%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.0015, Accuracy: 3624/8968 (40.4103%)
Scaling by  200
Scaled Norm after poisoning: 486.63692831514544, distance: 485.1946452198334
Total norm for 4 adversaries is: 486.63692831514544. distance: 485.1946452198334
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0231, Accuracy: 382/600 (63.6667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2476, Accuracy: 5716/10000 (57.1600%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0209, Accuracy: 380/600 (63.3333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9914, Accuracy: 6558/10000 (65.5800%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0204, Accuracy: 390/600 (65.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9476, Accuracy: 6519/10000 (65.1900%)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0231, Accuracy: 381/600 (63.5000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0813, Accuracy: 6645/10000 (66.4500%)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0236, Accuracy: 364/600 (60.6667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0805, Accuracy: 6942/10000 (69.4200%)
___Train Local_Simple,  epoch  14, local model 15, internal_epoch   1,  Average loss: 0.0210, Accuracy: 382/600 (63.6667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9757, Accuracy: 6490/10000 (64.9000%)
___Train Local_Simple,  epoch  14, local model 16, internal_epoch   1,  Average loss: 0.0190, Accuracy: 404/600 (67.3333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.4876, Accuracy: 5064/10000 (50.6400%)
___Train Local_Simple,  epoch  14, local model 17, internal_epoch   1,  Average loss: 0.0200, Accuracy: 384/600 (64.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1749, Accuracy: 6572/10000 (65.7200%)
___Train Local_Simple,  epoch  14, local model 18, internal_epoch   1,  Average loss: 0.0231, Accuracy: 388/600 (64.6667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.7675, Accuracy: 5182/10000 (51.8200%)
___Train Local_Simple,  epoch  14, local model 19, internal_epoch   1,  Average loss: 0.0235, Accuracy: 369/600 (61.5000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9293, Accuracy: 6970/10000 (69.7000%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0210, Accuracy: 402/600 (67.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9251, Accuracy: 7303/10000 (73.0300%)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 389/600 (64.8333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7973, Accuracy: 7173/10000 (71.7300%)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0203, Accuracy: 416/600 (69.3333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8820, Accuracy: 6787/10000 (67.8700%)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0192, Accuracy: 382/600 (63.6667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0390, Accuracy: 6631/10000 (66.3100%)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0225, Accuracy: 379/600 (63.1667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4604, Accuracy: 5565/10000 (55.6500%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0204, Accuracy: 376/600 (62.6667%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0020, Accuracy: 6513/10000 (65.1300%)
___Train Local_Simple,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0216, Accuracy: 401/600 (66.8333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0651, Accuracy: 6245/10000 (62.4500%)
time spent on training: 39.62597465515137
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[4]
Removed Outlier's influence 4
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.7205, Accuracy: 6648/10000 (66.4800%)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 2.3847, Accuracy: 215/8968 (2.3974%)
[Epoch 14] Backdoor Accuracy (combine): 215/8968 (2.40%)
Done in 50.29026794433594 sec.
Server Epoch:15 choose agents : [0, 2, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14, 1, 3, 4].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0221, Accuracy: 383/600 (63.8333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1734, Accuracy: 6795/10000 (67.9500%)
___Train Local_Simple,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0203, Accuracy: 386/600 (64.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8082, Accuracy: 7166/10000 (71.6600%)
___Train Local_Simple,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0199, Accuracy: 383/600 (63.8333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1416, Accuracy: 6577/10000 (65.7700%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0212, Accuracy: 390/600 (65.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9565, Accuracy: 6724/10000 (67.2400%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0290, Accuracy: 378/600 (63.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.9133, Accuracy: 4954/10000 (49.5400%)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0214, Accuracy: 402/600 (67.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0961, Accuracy: 6876/10000 (68.7600%)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0180, Accuracy: 404/600 (67.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8739, Accuracy: 7333/10000 (73.3300%)
___Train Local_Simple,  epoch  15, local model 15, internal_epoch   1,  Average loss: 0.0221, Accuracy: 384/600 (64.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1566, Accuracy: 5825/10000 (58.2500%)
___Train Local_Simple,  epoch  15, local model 16, internal_epoch   1,  Average loss: 0.0218, Accuracy: 388/600 (64.6667%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0874, Accuracy: 6468/10000 (64.6800%)
___Train Local_Simple,  epoch  15, local model 17, internal_epoch   1,  Average loss: 0.0239, Accuracy: 372/600 (62.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.4041, Accuracy: 6101/10000 (61.0100%)
___Train Local_Simple,  epoch  15, local model 18, internal_epoch   1,  Average loss: 0.0238, Accuracy: 379/600 (63.1667%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.2168, Accuracy: 6946/10000 (69.4600%)
___Train Local_Simple,  epoch  15, local model 19, internal_epoch   1,  Average loss: 0.0201, Accuracy: 392/600 (65.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7520, Accuracy: 7521/10000 (75.2100%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0225, Accuracy: 395/600 (65.8333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.2293, Accuracy: 5958/10000 (59.5800%)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0199, Accuracy: 375/600 (62.5000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0505, Accuracy: 6303/10000 (63.0300%)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0191, Accuracy: 414/600 (69.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0821, Accuracy: 6106/10000 (61.0600%)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0178, Accuracy: 414/600 (69.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9796, Accuracy: 6967/10000 (69.6700%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0205, Accuracy: 390/600 (65.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7544, Accuracy: 7492/10000 (74.9200%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0190, Accuracy: 404/600 (67.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8458, Accuracy: 7080/10000 (70.8000%)
___Train Local_Simple,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0191, Accuracy: 406/600 (67.6667%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.6838, Accuracy: 5030/10000 (50.3000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0201, Accuracy: 407/600 (67.8333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9617, Accuracy: 6567/10000 (65.6700%)
time spent on training: 35.417996883392334
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.6179, Accuracy: 6731/10000 (67.3100%)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 2.4025, Accuracy: 233/8968 (2.5981%)
[Epoch 15] Backdoor Accuracy (combine): 233/8968 (2.60%)
Done in 45.52896595001221 sec.
Server Epoch:16 choose agents : [0, 2, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 7, 8, 10, 13, 14, 1, 3, 4].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.0209, Accuracy: 377/600 (62.8333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0291, Accuracy: 7408/10000 (74.0800%)
___Train Local_Simple,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0208, Accuracy: 403/600 (67.1667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8739, Accuracy: 7323/10000 (73.2300%)
___Train Local_Simple,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0225, Accuracy: 368/600 (61.3333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0806, Accuracy: 6240/10000 (62.4000%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0190, Accuracy: 408/600 (68.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9298, Accuracy: 7187/10000 (71.8700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0182, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8442, Accuracy: 7034/10000 (70.3400%)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0209, Accuracy: 378/600 (63.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2393, Accuracy: 6344/10000 (63.4400%)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0181, Accuracy: 390/600 (65.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2173, Accuracy: 5729/10000 (57.2900%)
___Train Local_Simple,  epoch  16, local model 15, internal_epoch   1,  Average loss: 0.0186, Accuracy: 405/600 (67.5000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1287, Accuracy: 5715/10000 (57.1500%)
___Train Local_Simple,  epoch  16, local model 16, internal_epoch   1,  Average loss: 0.0171, Accuracy: 430/600 (71.6667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0372, Accuracy: 6524/10000 (65.2400%)
___Train Local_Simple,  epoch  16, local model 17, internal_epoch   1,  Average loss: 0.0222, Accuracy: 370/600 (61.6667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2218, Accuracy: 6826/10000 (68.2600%)
___Train Local_Simple,  epoch  16, local model 18, internal_epoch   1,  Average loss: 0.0198, Accuracy: 391/600 (65.1667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0537, Accuracy: 6360/10000 (63.6000%)
___Train Local_Simple,  epoch  16, local model 19, internal_epoch   1,  Average loss: 0.0185, Accuracy: 397/600 (66.1667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7597, Accuracy: 7045/10000 (70.4500%)
poison local model 7 index 2 
poison_now
/Users/shafayat/miniforge3/envs/torch_env/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:595: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  _warn_get_lr_called_within_step(self)
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0249, Accuracy: 300/600 (50.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   2,  Average loss: 0.0216, Accuracy: 320/600 (53.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   3,  Average loss: 0.0202, Accuracy: 295/600 (49.1667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   4,  Average loss: 0.0165, Accuracy: 373/600 (62.1667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   5,  Average loss: 0.0150, Accuracy: 344/600 (57.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   6,  Average loss: 0.0141, Accuracy: 357/600 (59.5000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   7,  Average loss: 0.0146, Accuracy: 351/600 (58.5000%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   8,  Average loss: 0.0137, Accuracy: 357/600 (59.5000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch   9,  Average loss: 0.0138, Accuracy: 372/600 (62.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 7, internal_epoch  10,  Average loss: 0.0132, Accuracy: 390/600 (65.0000%), train_poison_data_count: 200
Global model norm: 14.180954015407757.
Norm before scaling: 14.61932471598354. Distance: 2.5762397115132702
will scale.
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8357, Accuracy: 6817/10000 (68.1700%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.9416, Accuracy: 3854/8968 (42.9750%)
Scaling by  200
Scaled Norm after poisoning: 516.603480679331, distance: 515.2479378900997
Total norm for 4 adversaries is: 516.603480679331. distance: 515.2479378900997
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0181, Accuracy: 389/600 (64.8333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0042, Accuracy: 6696/10000 (66.9600%)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0183, Accuracy: 416/600 (69.3333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8038, Accuracy: 7345/10000 (73.4500%)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0186, Accuracy: 401/600 (66.8333%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8287, Accuracy: 7209/10000 (72.0900%)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0184, Accuracy: 399/600 (66.5000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8938, Accuracy: 6954/10000 (69.5400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0192, Accuracy: 400/600 (66.6667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9202, Accuracy: 6691/10000 (66.9100%)
___Train Local_Simple,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0175, Accuracy: 417/600 (69.5000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7933, Accuracy: 7110/10000 (71.1000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0199, Accuracy: 405/600 (67.5000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0421, Accuracy: 6072/10000 (60.7200%)
time spent on training: 36.74359703063965
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[7]
Removed Outlier's influence 7
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.5073, Accuracy: 6930/10000 (69.3000%)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 2.4436, Accuracy: 239/8968 (2.6650%)
[Epoch 16] Backdoor Accuracy (combine): 239/8968 (2.67%)
Done in 46.68707203865051 sec.
Server Epoch:17 choose agents : [0, 2, 5, 6, 9, 11, 12, 15, 16, 17, 18, 19, 8, 10, 13, 14, 1, 3, 4, 7].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0180, Accuracy: 428/600 (71.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8619, Accuracy: 7443/10000 (74.4300%)
___Train Local_Simple,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0203, Accuracy: 396/600 (66.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9853, Accuracy: 6516/10000 (65.1600%)
___Train Local_Simple,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0184, Accuracy: 416/600 (69.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7211, Accuracy: 7970/10000 (79.7000%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0189, Accuracy: 410/600 (68.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7616, Accuracy: 7790/10000 (77.9000%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0194, Accuracy: 425/600 (70.8333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0392, Accuracy: 6495/10000 (64.9500%)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0158, Accuracy: 434/600 (72.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8114, Accuracy: 7175/10000 (71.7500%)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0167, Accuracy: 422/600 (70.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9523, Accuracy: 6739/10000 (67.3900%)
___Train Local_Simple,  epoch  17, local model 15, internal_epoch   1,  Average loss: 0.0193, Accuracy: 397/600 (66.1667%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9498, Accuracy: 7484/10000 (74.8400%)
___Train Local_Simple,  epoch  17, local model 16, internal_epoch   1,  Average loss: 0.0166, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7521, Accuracy: 7115/10000 (71.1500%)
___Train Local_Simple,  epoch  17, local model 17, internal_epoch   1,  Average loss: 0.0167, Accuracy: 426/600 (71.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9966, Accuracy: 6646/10000 (66.4600%)
___Train Local_Simple,  epoch  17, local model 18, internal_epoch   1,  Average loss: 0.0193, Accuracy: 414/600 (69.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9765, Accuracy: 6574/10000 (65.7400%)
___Train Local_Simple,  epoch  17, local model 19, internal_epoch   1,  Average loss: 0.0228, Accuracy: 391/600 (65.1667%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.5611, Accuracy: 6781/10000 (67.8100%)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0181, Accuracy: 394/600 (65.6667%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8640, Accuracy: 6831/10000 (68.3100%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0179, Accuracy: 421/600 (70.1667%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.2344, Accuracy: 5798/10000 (57.9800%)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0171, Accuracy: 411/600 (68.5000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7485, Accuracy: 7444/10000 (74.4400%)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0175, Accuracy: 418/600 (69.6667%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7812, Accuracy: 7527/10000 (75.2700%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0173, Accuracy: 410/600 (68.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9180, Accuracy: 6850/10000 (68.5000%)
___Train Local_Simple,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0169, Accuracy: 423/600 (70.5000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8553, Accuracy: 6618/10000 (66.1800%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0176, Accuracy: 404/600 (67.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8458, Accuracy: 6941/10000 (69.4100%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0159, Accuracy: 437/600 (72.8333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8269, Accuracy: 7311/10000 (73.1100%)
time spent on training: 33.72353219985962
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[19]
Removed Outlier's influence 19
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.3875, Accuracy: 7111/10000 (71.1100%)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 2.4986, Accuracy: 236/8968 (2.6316%)
[Epoch 17] Backdoor Accuracy (combine): 236/8968 (2.63%)
Done in 44.33338928222656 sec.
Server Epoch:18 choose agents : [0, 2, 5, 6, 9, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 1, 3, 4, 7, 19].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.0150, Accuracy: 437/600 (72.8333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9246, Accuracy: 7014/10000 (70.1400%)
___Train Local_Simple,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0167, Accuracy: 423/600 (70.5000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7188, Accuracy: 7401/10000 (74.0100%)
___Train Local_Simple,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 416/600 (69.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7512, Accuracy: 7747/10000 (77.4700%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0170, Accuracy: 428/600 (71.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9505, Accuracy: 6401/10000 (64.0100%)
poison local model 9 index 3 
poison_now
/Users/shafayat/miniforge3/envs/torch_env/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:595: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  _warn_get_lr_called_within_step(self)
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0228, Accuracy: 323/600 (53.8333%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   2,  Average loss: 0.0191, Accuracy: 316/600 (52.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   3,  Average loss: 0.0182, Accuracy: 327/600 (54.5000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   4,  Average loss: 0.0141, Accuracy: 413/600 (68.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   5,  Average loss: 0.0123, Accuracy: 413/600 (68.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   6,  Average loss: 0.0109, Accuracy: 448/600 (74.6667%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   7,  Average loss: 0.0091, Accuracy: 487/600 (81.1667%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   8,  Average loss: 0.0068, Accuracy: 531/600 (88.5000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch   9,  Average loss: 0.0063, Accuracy: 536/600 (89.3333%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 9, internal_epoch  10,  Average loss: 0.0059, Accuracy: 536/600 (89.3333%), train_poison_data_count: 200
Global model norm: 14.241488407657034.
Norm before scaling: 14.752314499123678. Distance: 2.7675746791174736
will scale.
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4996, Accuracy: 8519/10000 (85.1900%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1469, Accuracy: 8637/8968 (96.3091%)
Scaling by  200
Scaled Norm after poisoning: 554.9881755497139, distance: 553.5149331770554
Total norm for 4 adversaries is: 554.9881755497139. distance: 553.5149331770554
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0160, Accuracy: 434/600 (72.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.0437, Accuracy: 6242/10000 (62.4200%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0172, Accuracy: 415/600 (69.1667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6521, Accuracy: 7864/10000 (78.6400%)
___Train Local_Simple,  epoch  18, local model 15, internal_epoch   1,  Average loss: 0.0190, Accuracy: 404/600 (67.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9036, Accuracy: 7828/10000 (78.2800%)
___Train Local_Simple,  epoch  18, local model 16, internal_epoch   1,  Average loss: 0.0145, Accuracy: 446/600 (74.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6362, Accuracy: 7852/10000 (78.5200%)
___Train Local_Simple,  epoch  18, local model 17, internal_epoch   1,  Average loss: 0.0172, Accuracy: 435/600 (72.5000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9713, Accuracy: 6868/10000 (68.6800%)
___Train Local_Simple,  epoch  18, local model 18, internal_epoch   1,  Average loss: 0.0173, Accuracy: 425/600 (70.8333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.0351, Accuracy: 6875/10000 (68.7500%)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0175, Accuracy: 409/600 (68.1667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6366, Accuracy: 8280/10000 (82.8000%)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0171, Accuracy: 427/600 (71.1667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7751, Accuracy: 7554/10000 (75.5400%)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0149, Accuracy: 431/600 (71.8333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5504, Accuracy: 8107/10000 (81.0700%)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0165, Accuracy: 417/600 (69.5000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6568, Accuracy: 7951/10000 (79.5100%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0160, Accuracy: 447/600 (74.5000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 5.1716, Accuracy: 3486/10000 (34.8600%)
___Train Local_Simple,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0168, Accuracy: 418/600 (69.6667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8152, Accuracy: 7162/10000 (71.6200%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0187, Accuracy: 406/600 (67.6667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8098, Accuracy: 7890/10000 (78.9000%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0160, Accuracy: 436/600 (72.6667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1276, Accuracy: 6783/10000 (67.8300%)
___Train Local_Simple,  epoch  18, local model 19, internal_epoch   1,  Average loss: 0.0156, Accuracy: 427/600 (71.1667%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8361, Accuracy: 6882/10000 (68.8200%)
time spent on training: 42.241600036621094
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[9]
Removed Outlier's influence 9
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.2660, Accuracy: 7283/10000 (72.8300%)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 2.5868, Accuracy: 214/8968 (2.3863%)
[Epoch 18] Backdoor Accuracy (combine): 214/8968 (2.39%)
Done in 52.61966395378113 sec.
Server Epoch:19 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 1, 3, 4, 7, 19, 9].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0203, Accuracy: 430/600 (71.6667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4218, Accuracy: 5936/10000 (59.3600%)
___Train Local_Simple,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0163, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7773, Accuracy: 7630/10000 (76.3000%)
___Train Local_Simple,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0162, Accuracy: 427/600 (71.1667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8641, Accuracy: 6646/10000 (66.4600%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0173, Accuracy: 416/600 (69.3333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8321, Accuracy: 7422/10000 (74.2200%)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0141, Accuracy: 444/600 (74.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7986, Accuracy: 7475/10000 (74.7500%)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0163, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7298, Accuracy: 7640/10000 (76.4000%)
___Train Local_Simple,  epoch  19, local model 15, internal_epoch   1,  Average loss: 0.0164, Accuracy: 425/600 (70.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7354, Accuracy: 7644/10000 (76.4400%)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0191, Accuracy: 413/600 (68.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.2651, Accuracy: 6298/10000 (62.9800%)
___Train Local_Simple,  epoch  19, local model 17, internal_epoch   1,  Average loss: 0.0157, Accuracy: 436/600 (72.6667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6778, Accuracy: 7990/10000 (79.9000%)
___Train Local_Simple,  epoch  19, local model 18, internal_epoch   1,  Average loss: 0.0172, Accuracy: 437/600 (72.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8191, Accuracy: 7426/10000 (74.2600%)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0178, Accuracy: 418/600 (69.6667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8722, Accuracy: 6885/10000 (68.8500%)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0162, Accuracy: 446/600 (74.3333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8707, Accuracy: 7392/10000 (73.9200%)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0131, Accuracy: 446/600 (74.3333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.1403, Accuracy: 5242/10000 (52.4200%)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0156, Accuracy: 427/600 (71.1667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8186, Accuracy: 6855/10000 (68.5500%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0151, Accuracy: 435/600 (72.5000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6512, Accuracy: 7834/10000 (78.3400%)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0186, Accuracy: 414/600 (69.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.1122, Accuracy: 7659/10000 (76.5900%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0165, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0652, Accuracy: 6021/10000 (60.2100%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0149, Accuracy: 452/600 (75.3333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0483, Accuracy: 6637/10000 (66.3700%)
___Train Local_Simple,  epoch  19, local model 19, internal_epoch   1,  Average loss: 0.0166, Accuracy: 413/600 (68.8333%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8787, Accuracy: 6937/10000 (69.3700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0155, Accuracy: 447/600 (74.5000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7407, Accuracy: 7735/10000 (77.3500%)
time spent on training: 34.398194789886475
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.1844, Accuracy: 7477/10000 (74.7700%)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 2.6452, Accuracy: 220/8968 (2.4532%)
[Epoch 19] Backdoor Accuracy (combine): 220/8968 (2.45%)
Done in 44.408323764801025 sec.
Server Epoch:20 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 1, 3, 4, 7, 19, 9].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.0174, Accuracy: 425/600 (70.8333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.1521, Accuracy: 5976/10000 (59.7600%)
___Train Local_Simple,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0159, Accuracy: 431/600 (71.8333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8707, Accuracy: 7176/10000 (71.7600%)
___Train Local_Simple,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0167, Accuracy: 423/600 (70.5000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0155, Accuracy: 6723/10000 (67.2300%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0142, Accuracy: 431/600 (71.8333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8091, Accuracy: 7408/10000 (74.0800%)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0150, Accuracy: 446/600 (74.3333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6210, Accuracy: 8365/10000 (83.6500%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0182, Accuracy: 424/600 (70.6667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0045, Accuracy: 6981/10000 (69.8100%)
___Train Local_Simple,  epoch  20, local model 15, internal_epoch   1,  Average loss: 0.0149, Accuracy: 429/600 (71.5000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.9473, Accuracy: 6885/10000 (68.8500%)
___Train Local_Simple,  epoch  20, local model 16, internal_epoch   1,  Average loss: 0.0150, Accuracy: 441/600 (73.5000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6787, Accuracy: 7559/10000 (75.5900%)
___Train Local_Simple,  epoch  20, local model 17, internal_epoch   1,  Average loss: 0.0124, Accuracy: 455/600 (75.8333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.1288, Accuracy: 6999/10000 (69.9900%)
___Train Local_Simple,  epoch  20, local model 18, internal_epoch   1,  Average loss: 0.0154, Accuracy: 438/600 (73.0000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0605, Accuracy: 6486/10000 (64.8600%)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0146, Accuracy: 440/600 (73.3333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6251, Accuracy: 7759/10000 (77.5900%)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0130, Accuracy: 466/600 (77.6667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0936, Accuracy: 6975/10000 (69.7500%)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0137, Accuracy: 446/600 (74.3333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6687, Accuracy: 7728/10000 (77.2800%)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0126, Accuracy: 454/600 (75.6667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0171, Accuracy: 7171/10000 (71.7100%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0141, Accuracy: 448/600 (74.6667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7061, Accuracy: 7388/10000 (73.8800%)
___Train Local_Simple,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0151, Accuracy: 463/600 (77.1667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7361, Accuracy: 7167/10000 (71.6700%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0138, Accuracy: 439/600 (73.1667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7674, Accuracy: 7477/10000 (74.7700%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0148, Accuracy: 448/600 (74.6667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8805, Accuracy: 7021/10000 (70.2100%)
___Train Local_Simple,  epoch  20, local model 19, internal_epoch   1,  Average loss: 0.0134, Accuracy: 453/600 (75.5000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5968, Accuracy: 8093/10000 (80.9300%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0122, Accuracy: 465/600 (77.5000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.9940, Accuracy: 7278/10000 (72.7800%)
time spent on training: 32.40285015106201
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.0712, Accuracy: 7639/10000 (76.3900%)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 2.7844, Accuracy: 202/8968 (2.2525%)
[Epoch 20] Backdoor Accuracy (combine): 202/8968 (2.25%)
Server Epoch:21 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 1, 3, 4, 7, 19, 9].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0127, Accuracy: 462/600 (77.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7317, Accuracy: 7392/10000 (73.9200%)
___Train Local_Simple,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0146, Accuracy: 456/600 (76.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0204, Accuracy: 6602/10000 (66.0200%)
___Train Local_Simple,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0130, Accuracy: 453/600 (75.5000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.4057, Accuracy: 6369/10000 (63.6900%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0171, Accuracy: 439/600 (73.1667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0912, Accuracy: 6659/10000 (66.5900%)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0124, Accuracy: 460/600 (76.6667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.1274, Accuracy: 6864/10000 (68.6400%)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0148, Accuracy: 438/600 (73.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8997, Accuracy: 7454/10000 (74.5400%)
___Train Local_Simple,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0171, Accuracy: 430/600 (71.6667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.1932, Accuracy: 5633/10000 (56.3300%)
___Train Local_Simple,  epoch  21, local model 16, internal_epoch   1,  Average loss: 0.0132, Accuracy: 461/600 (76.8333%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8039, Accuracy: 7133/10000 (71.3300%)
___Train Local_Simple,  epoch  21, local model 17, internal_epoch   1,  Average loss: 0.0120, Accuracy: 474/600 (79.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7243, Accuracy: 7665/10000 (76.6500%)
___Train Local_Simple,  epoch  21, local model 18, internal_epoch   1,  Average loss: 0.0129, Accuracy: 463/600 (77.1667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7701, Accuracy: 7591/10000 (75.9100%)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0160, Accuracy: 435/600 (72.5000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9294, Accuracy: 6853/10000 (68.5300%)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0119, Accuracy: 475/600 (79.1667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5507, Accuracy: 8240/10000 (82.4000%)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0133, Accuracy: 466/600 (77.6667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8348, Accuracy: 7689/10000 (76.8900%)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0176, Accuracy: 439/600 (73.1667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0350, Accuracy: 6779/10000 (67.7900%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0133, Accuracy: 444/600 (74.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5710, Accuracy: 8069/10000 (80.6900%)
___Train Local_Simple,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0137, Accuracy: 457/600 (76.1667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6316, Accuracy: 7821/10000 (78.2100%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0137, Accuracy: 443/600 (73.8333%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6027, Accuracy: 8126/10000 (81.2600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0130, Accuracy: 467/600 (77.8333%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0687, Accuracy: 6654/10000 (66.5400%)
___Train Local_Simple,  epoch  21, local model 19, internal_epoch   1,  Average loss: 0.0133, Accuracy: 465/600 (77.5000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7241, Accuracy: 7802/10000 (78.0200%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0153, Accuracy: 460/600 (76.6667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.2500, Accuracy: 5886/10000 (58.8600%)
time spent on training: 35.790335178375244
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.9741, Accuracy: 7780/10000 (77.8000%)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 2.9184, Accuracy: 202/8968 (2.2525%)
[Epoch 21] Backdoor Accuracy (combine): 202/8968 (2.25%)
Done in 45.924335956573486 sec.
Server Epoch:22 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 1, 3, 4, 7, 19, 9].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.0128, Accuracy: 466/600 (77.6667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6953, Accuracy: 7496/10000 (74.9600%)
___Train Local_Simple,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0135, Accuracy: 463/600 (77.1667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7312, Accuracy: 7714/10000 (77.1400%)
___Train Local_Simple,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0123, Accuracy: 460/600 (76.6667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7741, Accuracy: 7410/10000 (74.1000%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0125, Accuracy: 458/600 (76.3333%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5920, Accuracy: 8077/10000 (80.7700%)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0133, Accuracy: 468/600 (78.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6886, Accuracy: 7675/10000 (76.7500%)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0125, Accuracy: 469/600 (78.1667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.4950, Accuracy: 6131/10000 (61.3100%)
___Train Local_Simple,  epoch  22, local model 15, internal_epoch   1,  Average loss: 0.0126, Accuracy: 467/600 (77.8333%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8359, Accuracy: 7786/10000 (77.8600%)
___Train Local_Simple,  epoch  22, local model 16, internal_epoch   1,  Average loss: 0.0122, Accuracy: 480/600 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5686, Accuracy: 8042/10000 (80.4200%)
___Train Local_Simple,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0113, Accuracy: 480/600 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9450, Accuracy: 6867/10000 (68.6700%)
___Train Local_Simple,  epoch  22, local model 18, internal_epoch   1,  Average loss: 0.0140, Accuracy: 443/600 (73.8333%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7825, Accuracy: 7576/10000 (75.7600%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0109, Accuracy: 475/600 (79.1667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6546, Accuracy: 8000/10000 (80.0000%)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0113, Accuracy: 478/600 (79.6667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7348, Accuracy: 7741/10000 (77.4100%)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0128, Accuracy: 466/600 (77.6667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7951, Accuracy: 7641/10000 (76.4100%)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0139, Accuracy: 454/600 (75.6667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9041, Accuracy: 7166/10000 (71.6600%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0125, Accuracy: 464/600 (77.3333%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7232, Accuracy: 7714/10000 (77.1400%)
___Train Local_Simple,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0117, Accuracy: 469/600 (78.1667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0678, Accuracy: 6880/10000 (68.8000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0129, Accuracy: 468/600 (78.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7471, Accuracy: 7246/10000 (72.4600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0104, Accuracy: 491/600 (81.8333%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.8156, Accuracy: 6052/10000 (60.5200%)
___Train Local_Simple,  epoch  22, local model 19, internal_epoch   1,  Average loss: 0.0134, Accuracy: 464/600 (77.3333%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0382, Accuracy: 6521/10000 (65.2100%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0128, Accuracy: 471/600 (78.5000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6522, Accuracy: 8118/10000 (81.1800%)
time spent on training: 38.88999795913696
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.8708, Accuracy: 7947/10000 (79.4700%)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 3.1423, Accuracy: 173/8968 (1.9291%)
[Epoch 22] Backdoor Accuracy (combine): 173/8968 (1.93%)
Done in 49.5484778881073 sec.
Server Epoch:31 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 9, 1, 4, 7].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0078, Accuracy: 522/600 (87.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4502, Accuracy: 8384/10000 (83.8400%)
___Train Local_Simple,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6135, Accuracy: 8237/10000 (82.3700%)
___Train Local_Simple,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0075, Accuracy: 523/600 (87.1667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3939, Accuracy: 8682/10000 (86.8200%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0076, Accuracy: 509/600 (84.8333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6714, Accuracy: 7627/10000 (76.2700%)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5214, Accuracy: 8359/10000 (83.5900%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 529/600 (88.1667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3139, Accuracy: 7404/10000 (74.0400%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   1,  Average loss: 0.0080, Accuracy: 516/600 (86.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3595, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch  31, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5559, Accuracy: 8496/10000 (84.9600%)
___Train Local_Simple,  epoch  31, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.7705, Accuracy: 6711/10000 (67.1100%)
___Train Local_Simple,  epoch  31, local model 18, internal_epoch   1,  Average loss: 0.0069, Accuracy: 519/600 (86.5000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8888, Accuracy: 7526/10000 (75.2600%)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 517/600 (86.1667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5607, Accuracy: 8224/10000 (82.2400%)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0064, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.9791, Accuracy: 5156/10000 (51.5600%)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0072, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4668, Accuracy: 8409/10000 (84.0900%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 523/600 (87.1667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4305, Accuracy: 8691/10000 (86.9100%)
___Train Local_Simple,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7088, Accuracy: 7905/10000 (79.0500%)
___Train Local_Simple,  epoch  31, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5729, Accuracy: 8271/10000 (82.7100%)
poison local model 9 index 3 
poison_now
/Users/shafayat/miniforge3/envs/torch_env/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:595: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  _warn_get_lr_called_within_step(self)
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0200, Accuracy: 348/600 (58.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0146, Accuracy: 396/600 (66.0000%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0099, Accuracy: 455/600 (75.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0073, Accuracy: 500/600 (83.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0060, Accuracy: 527/600 (87.8333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0049, Accuracy: 548/600 (91.3333%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0038, Accuracy: 559/600 (93.1667%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0030, Accuracy: 571/600 (95.1667%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0026, Accuracy: 570/600 (95.0000%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0032, Accuracy: 565/600 (94.1667%), train_poison_data_count: 200
Global model norm: 14.543449285305664.
Norm before scaling: 14.948113282225359. Distance: 2.701204621067554
will scale.
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3533, Accuracy: 8885/10000 (88.8500%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0533, Accuracy: 8802/8968 (98.1490%)
Scaling by  200
Scaled Norm after poisoning: 541.2941379231813, distance: 540.2409474021754
Total norm for 4 adversaries is: 541.2941379231813. distance: 540.2409474021754
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0000, Accuracy: 8968/8968 (100.0000%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0071, Accuracy: 521/600 (86.8333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6485, Accuracy: 7840/10000 (78.4000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 526/600 (87.6667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9359, Accuracy: 7252/10000 (72.5200%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 526/600 (87.6667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6789, Accuracy: 7868/10000 (78.6800%)
time spent on training: 36.04009819030762
Counter({np.int64(0): 19, np.int64(-1): 1}) 2
[9]
Removed Outlier's influence 9
lengthof agents: 19
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.3758, Accuracy: 8980/10000 (89.8000%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 5.7140, Accuracy: 101/8968 (1.1262%)
[Epoch 31] Backdoor Accuracy (combine): 101/8968 (1.13%)
Done in 45.66530919075012 sec.
Server Epoch:32 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7181, Accuracy: 7591/10000 (75.9100%)
___Train Local_Simple,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5640, Accuracy: 8425/10000 (84.2500%)
___Train Local_Simple,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0069, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4272, Accuracy: 8650/10000 (86.5000%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0064, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3997, Accuracy: 8669/10000 (86.6900%)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4604, Accuracy: 8631/10000 (86.3100%)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 528/600 (88.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3853, Accuracy: 8857/10000 (88.5700%)
___Train Local_Simple,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0069, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5317, Accuracy: 8328/10000 (83.2800%)
___Train Local_Simple,  epoch  32, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7721, Accuracy: 7622/10000 (76.2200%)
___Train Local_Simple,  epoch  32, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4920, Accuracy: 8569/10000 (85.6900%)
___Train Local_Simple,  epoch  32, local model 18, internal_epoch   1,  Average loss: 0.0067, Accuracy: 525/600 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6252, Accuracy: 8230/10000 (82.3000%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 529/600 (88.1667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5823, Accuracy: 8022/10000 (80.2200%)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3838, Accuracy: 8878/10000 (88.7800%)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6837, Accuracy: 7873/10000 (78.7300%)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0072, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4647, Accuracy: 8515/10000 (85.1500%)
___Train Local_Simple,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4157, Accuracy: 8512/10000 (85.1200%)
___Train Local_Simple,  epoch  32, local model 19, internal_epoch   1,  Average loss: 0.0088, Accuracy: 525/600 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.8420, Accuracy: 5548/10000 (55.4800%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0072, Accuracy: 528/600 (88.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6887, Accuracy: 7477/10000 (74.7700%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 527/600 (87.8333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5493, Accuracy: 8218/10000 (82.1800%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3772, Accuracy: 8798/10000 (87.9800%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0063, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.0270, Accuracy: 7254/10000 (72.5400%)
time spent on training: 30.824864149093628
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.3498, Accuracy: 9040/10000 (90.4000%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 5.9951, Accuracy: 93/8968 (1.0370%)
[Epoch 32] Backdoor Accuracy (combine): 93/8968 (1.04%)
Done in 40.399338245391846 sec.
Server Epoch:33 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0071, Accuracy: 529/600 (88.1667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6762, Accuracy: 7762/10000 (77.6200%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 529/600 (88.1667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4605, Accuracy: 8539/10000 (85.3900%)
___Train Local_Simple,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4620, Accuracy: 8483/10000 (84.8300%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 528/600 (88.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3965, Accuracy: 8799/10000 (87.9900%)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5302, Accuracy: 8359/10000 (83.5900%)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4667, Accuracy: 8509/10000 (85.0900%)
___Train Local_Simple,  epoch  33, local model 15, internal_epoch   1,  Average loss: 0.0064, Accuracy: 524/600 (87.3333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6706, Accuracy: 7771/10000 (77.7100%)
___Train Local_Simple,  epoch  33, local model 16, internal_epoch   1,  Average loss: 0.0068, Accuracy: 528/600 (88.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6582, Accuracy: 7965/10000 (79.6500%)
___Train Local_Simple,  epoch  33, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7558, Accuracy: 7745/10000 (77.4500%)
___Train Local_Simple,  epoch  33, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5621, Accuracy: 8185/10000 (81.8500%)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 529/600 (88.1667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3735, Accuracy: 8832/10000 (88.3200%)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4045, Accuracy: 8806/10000 (88.0600%)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5036, Accuracy: 8559/10000 (85.5900%)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7647, Accuracy: 8085/10000 (80.8500%)
___Train Local_Simple,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0069, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8158, Accuracy: 7073/10000 (70.7300%)
___Train Local_Simple,  epoch  33, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5160, Accuracy: 8340/10000 (83.4000%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3060, Accuracy: 9002/10000 (90.0200%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8706, Accuracy: 7510/10000 (75.1000%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4671, Accuracy: 8560/10000 (85.6000%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5401, Accuracy: 8281/10000 (82.8100%)
time spent on training: 32.07411813735962
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.3277, Accuracy: 9093/10000 (90.9300%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 6.1916, Accuracy: 93/8968 (1.0370%)
[Epoch 33] Backdoor Accuracy (combine): 93/8968 (1.04%)
Done in 42.385765075683594 sec.
Server Epoch:34 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3483, Accuracy: 8880/10000 (88.8000%)
___Train Local_Simple,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3514, Accuracy: 8914/10000 (89.1400%)
___Train Local_Simple,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.6982, Accuracy: 7080/10000 (70.8000%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0067, Accuracy: 526/600 (87.6667%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3934, Accuracy: 8761/10000 (87.6100%)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 525/600 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4945, Accuracy: 8395/10000 (83.9500%)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 525/600 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4625, Accuracy: 8548/10000 (85.4800%)
___Train Local_Simple,  epoch  34, local model 15, internal_epoch   1,  Average loss: 0.0064, Accuracy: 527/600 (87.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6197, Accuracy: 8047/10000 (80.4700%)
___Train Local_Simple,  epoch  34, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4477, Accuracy: 8589/10000 (85.8900%)
___Train Local_Simple,  epoch  34, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 515/600 (85.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6406, Accuracy: 7824/10000 (78.2400%)
___Train Local_Simple,  epoch  34, local model 18, internal_epoch   1,  Average loss: 0.0070, Accuracy: 518/600 (86.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4386, Accuracy: 8498/10000 (84.9800%)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5146, Accuracy: 8304/10000 (83.0400%)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6546, Accuracy: 7955/10000 (79.5500%)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5819, Accuracy: 8272/10000 (82.7200%)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3880, Accuracy: 8833/10000 (88.3300%)
___Train Local_Simple,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3343, Accuracy: 9014/10000 (90.1400%)
___Train Local_Simple,  epoch  34, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5176, Accuracy: 8370/10000 (83.7000%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3656, Accuracy: 8829/10000 (88.2900%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3568, Accuracy: 8868/10000 (88.6800%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4780, Accuracy: 8583/10000 (85.8300%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4271, Accuracy: 8723/10000 (87.2300%)
time spent on training: 32.026638984680176
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.3096, Accuracy: 9126/10000 (91.2600%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 6.3857, Accuracy: 91/8968 (1.0147%)
[Epoch 34] Backdoor Accuracy (combine): 91/8968 (1.01%)
Done in 41.83984589576721 sec.
Server Epoch:35 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0066, Accuracy: 524/600 (87.3333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6264, Accuracy: 7910/10000 (79.1000%)
___Train Local_Simple,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.3281, Accuracy: 6874/10000 (68.7400%)
___Train Local_Simple,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4539, Accuracy: 8597/10000 (85.9700%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 524/600 (87.3333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4397, Accuracy: 8669/10000 (86.6900%)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4463, Accuracy: 8506/10000 (85.0600%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5252, Accuracy: 8322/10000 (83.2200%)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0063, Accuracy: 526/600 (87.6667%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6139, Accuracy: 7897/10000 (78.9700%)
___Train Local_Simple,  epoch  35, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3223, Accuracy: 8940/10000 (89.4000%)
___Train Local_Simple,  epoch  35, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6175, Accuracy: 8241/10000 (82.4100%)
___Train Local_Simple,  epoch  35, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 522/600 (87.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4432, Accuracy: 8567/10000 (85.6700%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 523/600 (87.1667%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7616, Accuracy: 7515/10000 (75.1500%)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 560/600 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3623, Accuracy: 8909/10000 (89.0900%)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4825, Accuracy: 8373/10000 (83.7300%)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 521/600 (86.8333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6023, Accuracy: 7979/10000 (79.7900%)
___Train Local_Simple,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5108, Accuracy: 8462/10000 (84.6200%)
___Train Local_Simple,  epoch  35, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.1459, Accuracy: 6697/10000 (66.9700%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3504, Accuracy: 8927/10000 (89.2700%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 528/600 (88.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4848, Accuracy: 8254/10000 (82.5400%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4628, Accuracy: 8678/10000 (86.7800%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3402, Accuracy: 9004/10000 (90.0400%)
time spent on training: 33.6423499584198
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.2934, Accuracy: 9171/10000 (91.7100%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 6.5608, Accuracy: 89/8968 (0.9924%)
[Epoch 35] Backdoor Accuracy (combine): 89/8968 (0.99%)
Done in 43.37301826477051 sec.
Server Epoch:36 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3278, Accuracy: 8989/10000 (89.8900%)
___Train Local_Simple,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8158, Accuracy: 7833/10000 (78.3300%)
___Train Local_Simple,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3384, Accuracy: 8936/10000 (89.3600%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0061, Accuracy: 524/600 (87.3333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6701, Accuracy: 7905/10000 (79.0500%)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3500, Accuracy: 8826/10000 (88.2600%)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4460, Accuracy: 8677/10000 (86.7700%)
___Train Local_Simple,  epoch  36, local model 15, internal_epoch   1,  Average loss: 0.0064, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6300, Accuracy: 7941/10000 (79.4100%)
___Train Local_Simple,  epoch  36, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7970, Accuracy: 7624/10000 (76.2400%)
___Train Local_Simple,  epoch  36, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3474, Accuracy: 8847/10000 (88.4700%)
___Train Local_Simple,  epoch  36, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5177, Accuracy: 8251/10000 (82.5100%)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 525/600 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5821, Accuracy: 7953/10000 (79.5300%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5279, Accuracy: 8506/10000 (85.0600%)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9906, Accuracy: 6915/10000 (69.1500%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5341, Accuracy: 8381/10000 (83.8100%)
___Train Local_Simple,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3854, Accuracy: 8853/10000 (88.5300%)
___Train Local_Simple,  epoch  36, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9577, Accuracy: 6844/10000 (68.4400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5244, Accuracy: 8430/10000 (84.3000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 528/600 (88.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5700, Accuracy: 8208/10000 (82.0800%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3832, Accuracy: 8935/10000 (89.3500%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6218, Accuracy: 8026/10000 (80.2600%)
time spent on training: 30.316200017929077
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.2785, Accuracy: 9217/10000 (92.1700%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 6.6733, Accuracy: 91/8968 (1.0147%)
[Epoch 36] Backdoor Accuracy (combine): 91/8968 (1.01%)
Done in 39.91495990753174 sec.
Server Epoch:37 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7298, Accuracy: 7999/10000 (79.9900%)
___Train Local_Simple,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6451, Accuracy: 7906/10000 (79.0600%)
___Train Local_Simple,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8785, Accuracy: 7084/10000 (70.8400%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8108, Accuracy: 7510/10000 (75.1000%)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4165, Accuracy: 8663/10000 (86.6300%)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4801, Accuracy: 8640/10000 (86.4000%)
___Train Local_Simple,  epoch  37, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6927, Accuracy: 7851/10000 (78.5100%)
___Train Local_Simple,  epoch  37, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4432, Accuracy: 8372/10000 (83.7200%)
___Train Local_Simple,  epoch  37, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4157, Accuracy: 8669/10000 (86.6900%)
___Train Local_Simple,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7169, Accuracy: 7710/10000 (77.1000%)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 522/600 (87.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7965, Accuracy: 7780/10000 (77.8000%)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8603, Accuracy: 7419/10000 (74.1900%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5168, Accuracy: 8406/10000 (84.0600%)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3672, Accuracy: 8918/10000 (89.1800%)
___Train Local_Simple,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6264, Accuracy: 8132/10000 (81.3200%)
___Train Local_Simple,  epoch  37, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5685, Accuracy: 8280/10000 (82.8000%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4722, Accuracy: 8601/10000 (86.0100%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7871, Accuracy: 7923/10000 (79.2300%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3599, Accuracy: 8867/10000 (88.6700%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4019, Accuracy: 8757/10000 (87.5700%)
time spent on training: 29.939851999282837
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.2656, Accuracy: 9257/10000 (92.5700%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 6.7957, Accuracy: 94/8968 (1.0482%)
[Epoch 37] Backdoor Accuracy (combine): 94/8968 (1.05%)
Done in 39.57138514518738 sec.
Server Epoch:38 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.6925, Accuracy: 6407/10000 (64.0700%)
___Train Local_Simple,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 556/600 (92.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3617, Accuracy: 8867/10000 (88.6700%)
___Train Local_Simple,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4557, Accuracy: 8656/10000 (86.5600%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0066, Accuracy: 524/600 (87.3333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3737, Accuracy: 8779/10000 (87.7900%)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3923, Accuracy: 8778/10000 (87.7800%)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.9054, Accuracy: 7588/10000 (75.8800%)
___Train Local_Simple,  epoch  38, local model 15, internal_epoch   1,  Average loss: 0.0063, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2798, Accuracy: 9142/10000 (91.4200%)
___Train Local_Simple,  epoch  38, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5204, Accuracy: 8254/10000 (82.5400%)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1713, Accuracy: 6657/10000 (66.5700%)
___Train Local_Simple,  epoch  38, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4331, Accuracy: 8605/10000 (86.0500%)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 530/600 (88.3333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6672, Accuracy: 7765/10000 (77.6500%)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3911, Accuracy: 8729/10000 (87.2900%)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3919, Accuracy: 8813/10000 (88.1300%)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3895, Accuracy: 8730/10000 (87.3000%)
___Train Local_Simple,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 532/600 (88.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3971, Accuracy: 8785/10000 (87.8500%)
___Train Local_Simple,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2760, Accuracy: 9138/10000 (91.3800%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0192, Accuracy: 7408/10000 (74.0800%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3909, Accuracy: 8765/10000 (87.6500%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2864, Accuracy: 9118/10000 (91.1800%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.2276, Accuracy: 7475/10000 (74.7500%)
time spent on training: 30.460295915603638
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.2558, Accuracy: 9284/10000 (92.8400%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 6.9390, Accuracy: 89/8968 (0.9924%)
[Epoch 38] Backdoor Accuracy (combine): 89/8968 (0.99%)
Done in 40.265965938568115 sec.
Server Epoch:39 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0784, Accuracy: 7077/10000 (70.7700%)
___Train Local_Simple,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 564/600 (94.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5681, Accuracy: 8154/10000 (81.5400%)
___Train Local_Simple,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.9454, Accuracy: 7567/10000 (75.6700%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3993, Accuracy: 8739/10000 (87.3900%)
___Train Local_Simple,  epoch  39, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4075, Accuracy: 8760/10000 (87.6000%)
___Train Local_Simple,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4162, Accuracy: 8834/10000 (88.3400%)
___Train Local_Simple,  epoch  39, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3784, Accuracy: 8831/10000 (88.3100%)
___Train Local_Simple,  epoch  39, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3025, Accuracy: 9075/10000 (90.7500%)
___Train Local_Simple,  epoch  39, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5800, Accuracy: 8282/10000 (82.8200%)
___Train Local_Simple,  epoch  39, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4408, Accuracy: 8545/10000 (85.4500%)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5118, Accuracy: 8299/10000 (82.9900%)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 564/600 (94.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4734, Accuracy: 8570/10000 (85.7000%)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7422, Accuracy: 8053/10000 (80.5300%)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4701, Accuracy: 8423/10000 (84.2300%)
___Train Local_Simple,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4320, Accuracy: 8616/10000 (86.1600%)
___Train Local_Simple,  epoch  39, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2941, Accuracy: 9018/10000 (90.1800%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 526/600 (87.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4049, Accuracy: 8653/10000 (86.5300%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0069, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4708, Accuracy: 8625/10000 (86.2500%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3310, Accuracy: 9004/10000 (90.0400%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2981, Accuracy: 9126/10000 (91.2600%)
time spent on training: 31.550798892974854
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.2471, Accuracy: 9308/10000 (93.0800%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 7.0355, Accuracy: 89/8968 (0.9924%)
[Epoch 39] Backdoor Accuracy (combine): 89/8968 (0.99%)
Done in 41.66910481452942 sec.
Server Epoch:40 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  40, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2876, Accuracy: 9106/10000 (91.0600%)
___Train Local_Simple,  epoch  40, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2360, Accuracy: 9312/10000 (93.1200%)
___Train Local_Simple,  epoch  40, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4280, Accuracy: 8617/10000 (86.1700%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5180, Accuracy: 8298/10000 (82.9800%)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0808, Accuracy: 6907/10000 (69.0700%)
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3397, Accuracy: 8895/10000 (88.9500%)
___Train Local_Simple,  epoch  40, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5152, Accuracy: 8277/10000 (82.7700%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3769, Accuracy: 8830/10000 (88.3000%)
___Train Local_Simple,  epoch  40, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3384, Accuracy: 9020/10000 (90.2000%)
___Train Local_Simple,  epoch  40, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4278, Accuracy: 8619/10000 (86.1900%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2558, Accuracy: 9264/10000 (92.6400%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3834, Accuracy: 8799/10000 (87.9900%)
___Train Local_Simple,  epoch  40, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6326, Accuracy: 8144/10000 (81.4400%)
___Train Local_Simple,  epoch  40, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3967, Accuracy: 8712/10000 (87.1200%)
___Train Local_Simple,  epoch  40, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4341, Accuracy: 8548/10000 (85.4800%)
___Train Local_Simple,  epoch  40, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4398, Accuracy: 8553/10000 (85.5300%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  40, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3530, Accuracy: 8920/10000 (89.2000%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  40, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3827, Accuracy: 8783/10000 (87.8300%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  40, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3868, Accuracy: 8753/10000 (87.5300%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  40, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7040, Accuracy: 7687/10000 (76.8700%)
time spent on training: 32.69409513473511
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.2384, Accuracy: 9323/10000 (93.2300%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 7.1481, Accuracy: 84/8968 (0.9367%)
[Epoch 40] Backdoor Accuracy (combine): 84/8968 (0.94%)
Done in 42.743054151535034 sec.
Server Epoch:41 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  41, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3992, Accuracy: 8763/10000 (87.6300%)
___Train Local_Simple,  epoch  41, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3354, Accuracy: 8947/10000 (89.4700%)
___Train Local_Simple,  epoch  41, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2918, Accuracy: 9102/10000 (91.0200%)
___Train Local_Simple,  epoch  41, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 527/600 (87.8333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6182, Accuracy: 8094/10000 (80.9400%)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4195, Accuracy: 8598/10000 (85.9800%)
___Train Local_Simple,  epoch  41, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4729, Accuracy: 8627/10000 (86.2700%)
___Train Local_Simple,  epoch  41, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4018, Accuracy: 8599/10000 (85.9900%)
___Train Local_Simple,  epoch  41, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5830, Accuracy: 8172/10000 (81.7200%)
___Train Local_Simple,  epoch  41, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4004, Accuracy: 8729/10000 (87.2900%)
___Train Local_Simple,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6090, Accuracy: 8051/10000 (80.5100%)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6172, Accuracy: 8038/10000 (80.3800%)
___Train Local_Simple,  epoch  41, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6505, Accuracy: 7993/10000 (79.9300%)
___Train Local_Simple,  epoch  41, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5554, Accuracy: 8073/10000 (80.7300%)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2627, Accuracy: 9189/10000 (91.8900%)
___Train Local_Simple,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4035, Accuracy: 8754/10000 (87.5400%)
___Train Local_Simple,  epoch  41, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3933, Accuracy: 8626/10000 (86.2600%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5612, Accuracy: 8155/10000 (81.5500%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5778, Accuracy: 8251/10000 (82.5100%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  41, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 568/600 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6780, Accuracy: 8051/10000 (80.5100%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8581, Accuracy: 7410/10000 (74.1000%)
time spent on training: 30.80300998687744
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.2312, Accuracy: 9345/10000 (93.4500%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 7.1932, Accuracy: 85/8968 (0.9478%)
[Epoch 41] Backdoor Accuracy (combine): 85/8968 (0.95%)
Done in 41.09095788002014 sec.
Server Epoch:42 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  42, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4475, Accuracy: 8473/10000 (84.7300%)
___Train Local_Simple,  epoch  42, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.7245, Accuracy: 7708/10000 (77.0800%)
___Train Local_Simple,  epoch  42, local model 5, internal_epoch   1,  Average loss: 0.0067, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4373, Accuracy: 8637/10000 (86.3700%)
___Train Local_Simple,  epoch  42, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3632, Accuracy: 8800/10000 (88.0000%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4579, Accuracy: 8534/10000 (85.3400%)
___Train Local_Simple,  epoch  42, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4105, Accuracy: 8737/10000 (87.3700%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3598, Accuracy: 8884/10000 (88.8400%)
___Train Local_Simple,  epoch  42, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3437, Accuracy: 8888/10000 (88.8800%)
___Train Local_Simple,  epoch  42, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6363, Accuracy: 8116/10000 (81.1600%)
___Train Local_Simple,  epoch  42, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5124, Accuracy: 8431/10000 (84.3100%)
___Train Local_Simple,  epoch  42, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4538, Accuracy: 8493/10000 (84.9300%)
___Train Local_Simple,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4551, Accuracy: 8513/10000 (85.1300%)
___Train Local_Simple,  epoch  42, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3250, Accuracy: 9072/10000 (90.7200%)
___Train Local_Simple,  epoch  42, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3685, Accuracy: 8741/10000 (87.4100%)
___Train Local_Simple,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4149, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  42, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6972, Accuracy: 7779/10000 (77.7900%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  42, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5549, Accuracy: 8296/10000 (82.9600%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3476, Accuracy: 8899/10000 (88.9900%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  42, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4901, Accuracy: 8414/10000 (84.1400%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  42, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9421, Accuracy: 7044/10000 (70.4400%)
time spent on training: 32.7568621635437
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.2246, Accuracy: 9368/10000 (93.6800%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 7.2888, Accuracy: 80/8968 (0.8921%)
[Epoch 42] Backdoor Accuracy (combine): 80/8968 (0.89%)
Done in 42.97721219062805 sec.
Server Epoch:43 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  43, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4027, Accuracy: 8559/10000 (85.5900%)
___Train Local_Simple,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 559/600 (93.1667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3901, Accuracy: 8817/10000 (88.1700%)
___Train Local_Simple,  epoch  43, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3733, Accuracy: 8870/10000 (88.7000%)
___Train Local_Simple,  epoch  43, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3053, Accuracy: 9050/10000 (90.5000%)
___Train Local_Simple,  epoch  43, local model 11, internal_epoch   1,  Average loss: 0.0046, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5424, Accuracy: 8177/10000 (81.7700%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0974, Accuracy: 6996/10000 (69.9600%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7598, Accuracy: 7867/10000 (78.6700%)
___Train Local_Simple,  epoch  43, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3302, Accuracy: 8804/10000 (88.0400%)
___Train Local_Simple,  epoch  43, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3486, Accuracy: 8929/10000 (89.2900%)
___Train Local_Simple,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3960, Accuracy: 8727/10000 (87.2700%)
___Train Local_Simple,  epoch  43, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2420, Accuracy: 9291/10000 (92.9100%)
___Train Local_Simple,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3028, Accuracy: 9106/10000 (91.0600%)
___Train Local_Simple,  epoch  43, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5947, Accuracy: 8164/10000 (81.6400%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3218, Accuracy: 8932/10000 (89.3200%)
___Train Local_Simple,  epoch  43, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3816, Accuracy: 8799/10000 (87.9900%)
___Train Local_Simple,  epoch  43, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3470, Accuracy: 8878/10000 (88.7800%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  43, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4043, Accuracy: 8715/10000 (87.1500%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  43, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5219, Accuracy: 8449/10000 (84.4900%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  43, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5726, Accuracy: 8120/10000 (81.2000%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 563/600 (93.8333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4837, Accuracy: 8533/10000 (85.3300%)
time spent on training: 32.85567903518677
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.2174, Accuracy: 9386/10000 (93.8600%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 7.3722, Accuracy: 76/8968 (0.8475%)
[Epoch 43] Backdoor Accuracy (combine): 76/8968 (0.85%)
Done in 43.060916900634766 sec.
Server Epoch:44 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3834, Accuracy: 8750/10000 (87.5000%)
___Train Local_Simple,  epoch  44, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4303, Accuracy: 8591/10000 (85.9100%)
___Train Local_Simple,  epoch  44, local model 5, internal_epoch   1,  Average loss: 0.0046, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3706, Accuracy: 8786/10000 (87.8600%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3616, Accuracy: 8865/10000 (88.6500%)
___Train Local_Simple,  epoch  44, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4557, Accuracy: 8478/10000 (84.7800%)
___Train Local_Simple,  epoch  44, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 559/600 (93.1667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5170, Accuracy: 8453/10000 (84.5300%)
___Train Local_Simple,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3823, Accuracy: 8811/10000 (88.1100%)
___Train Local_Simple,  epoch  44, local model 16, internal_epoch   1,  Average loss: 0.0048, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4351, Accuracy: 8489/10000 (84.8900%)
___Train Local_Simple,  epoch  44, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 545/600 (90.8333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5714, Accuracy: 8083/10000 (80.8300%)
___Train Local_Simple,  epoch  44, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2917, Accuracy: 9145/10000 (91.4500%)
___Train Local_Simple,  epoch  44, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4866, Accuracy: 8438/10000 (84.3800%)
___Train Local_Simple,  epoch  44, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 556/600 (92.6667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5082, Accuracy: 8294/10000 (82.9400%)
___Train Local_Simple,  epoch  44, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3842, Accuracy: 8847/10000 (88.4700%)
___Train Local_Simple,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3512, Accuracy: 8828/10000 (88.2800%)
___Train Local_Simple,  epoch  44, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4957, Accuracy: 8311/10000 (83.1100%)
___Train Local_Simple,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3716, Accuracy: 8894/10000 (88.9400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5732, Accuracy: 8119/10000 (81.1900%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  44, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 542/600 (90.3333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3290, Accuracy: 9045/10000 (90.4500%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  44, local model 7, internal_epoch   1,  Average loss: 0.0034, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6362, Accuracy: 8366/10000 (83.6600%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3382, Accuracy: 8915/10000 (89.1500%)
time spent on training: 30.87381410598755
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.2108, Accuracy: 9405/10000 (94.0500%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 7.4758, Accuracy: 74/8968 (0.8252%)
[Epoch 44] Backdoor Accuracy (combine): 74/8968 (0.83%)
Done in 40.60564923286438 sec.
Server Epoch:45 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  45, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 536/600 (89.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5510, Accuracy: 8112/10000 (81.1200%)
___Train Local_Simple,  epoch  45, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5119, Accuracy: 8516/10000 (85.1600%)
___Train Local_Simple,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 559/600 (93.1667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2728, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  45, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4325, Accuracy: 8637/10000 (86.3700%)
___Train Local_Simple,  epoch  45, local model 11, internal_epoch   1,  Average loss: 0.0054, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4448, Accuracy: 8505/10000 (85.0500%)
___Train Local_Simple,  epoch  45, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4568, Accuracy: 8461/10000 (84.6100%)
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2677, Accuracy: 9121/10000 (91.2100%)
___Train Local_Simple,  epoch  45, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3424, Accuracy: 8863/10000 (88.6300%)
___Train Local_Simple,  epoch  45, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 560/600 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2542, Accuracy: 9216/10000 (92.1600%)
___Train Local_Simple,  epoch  45, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4422, Accuracy: 8573/10000 (85.7300%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 537/600 (89.5000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3638, Accuracy: 8805/10000 (88.0500%)
___Train Local_Simple,  epoch  45, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 566/600 (94.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3038, Accuracy: 9065/10000 (90.6500%)
___Train Local_Simple,  epoch  45, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3586, Accuracy: 8913/10000 (89.1300%)
___Train Local_Simple,  epoch  45, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4832, Accuracy: 8503/10000 (85.0300%)
___Train Local_Simple,  epoch  45, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2977, Accuracy: 9064/10000 (90.6400%)
___Train Local_Simple,  epoch  45, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 556/600 (92.6667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4431, Accuracy: 8484/10000 (84.8400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3346, Accuracy: 8966/10000 (89.6600%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  45, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3648, Accuracy: 8789/10000 (87.8900%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  45, local model 7, internal_epoch   1,  Average loss: 0.0034, Accuracy: 560/600 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5617, Accuracy: 8219/10000 (82.1900%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  45, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 559/600 (93.1667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4215, Accuracy: 8643/10000 (86.4300%)
time spent on training: 29.957326889038086
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.2054, Accuracy: 9424/10000 (94.2400%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 7.5531, Accuracy: 72/8968 (0.8029%)
[Epoch 45] Backdoor Accuracy (combine): 72/8968 (0.80%)
Done in 39.609752893447876 sec.
Server Epoch:46 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  46, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3687, Accuracy: 8764/10000 (87.6400%)
___Train Local_Simple,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3017, Accuracy: 9099/10000 (90.9900%)
___Train Local_Simple,  epoch  46, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6008, Accuracy: 8227/10000 (82.2700%)
___Train Local_Simple,  epoch  46, local model 6, internal_epoch   1,  Average loss: 0.0066, Accuracy: 538/600 (89.6667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6684, Accuracy: 7743/10000 (77.4300%)
___Train Local_Simple,  epoch  46, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3411, Accuracy: 8852/10000 (88.5200%)
___Train Local_Simple,  epoch  46, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5149, Accuracy: 8366/10000 (83.6600%)
___Train Local_Simple,  epoch  46, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3937, Accuracy: 8796/10000 (87.9600%)
___Train Local_Simple,  epoch  46, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7057, Accuracy: 7538/10000 (75.3800%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 560/600 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6332, Accuracy: 8383/10000 (83.8300%)
___Train Local_Simple,  epoch  46, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3503, Accuracy: 8806/10000 (88.0600%)
___Train Local_Simple,  epoch  46, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 531/600 (88.5000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6598, Accuracy: 7888/10000 (78.8800%)
___Train Local_Simple,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4321, Accuracy: 8753/10000 (87.5300%)
___Train Local_Simple,  epoch  46, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5718, Accuracy: 8174/10000 (81.7400%)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2507, Accuracy: 9225/10000 (92.2500%)
___Train Local_Simple,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.3198, Accuracy: 6165/10000 (61.6500%)
___Train Local_Simple,  epoch  46, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.2029, Accuracy: 6504/10000 (65.0400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  46, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4201, Accuracy: 8611/10000 (86.1100%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 556/600 (92.6667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3200, Accuracy: 8946/10000 (89.4600%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 568/600 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2534, Accuracy: 9280/10000 (92.8000%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  46, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4562, Accuracy: 8514/10000 (85.1400%)
time spent on training: 30.415880918502808
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.2002, Accuracy: 9429/10000 (94.2900%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 7.5890, Accuracy: 72/8968 (0.8029%)
[Epoch 46] Backdoor Accuracy (combine): 72/8968 (0.80%)
Done in 39.922548055648804 sec.
Server Epoch:47 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3831, Accuracy: 8845/10000 (88.4500%)
___Train Local_Simple,  epoch  47, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4108, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 562/600 (93.6667%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6089, Accuracy: 8055/10000 (80.5500%)
___Train Local_Simple,  epoch  47, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7361, Accuracy: 7880/10000 (78.8000%)
___Train Local_Simple,  epoch  47, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 539/600 (89.8333%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3217, Accuracy: 8959/10000 (89.5900%)
___Train Local_Simple,  epoch  47, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2336, Accuracy: 9297/10000 (92.9700%)
___Train Local_Simple,  epoch  47, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 543/600 (90.5000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5135, Accuracy: 8215/10000 (82.1500%)
___Train Local_Simple,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3403, Accuracy: 8894/10000 (88.9400%)
___Train Local_Simple,  epoch  47, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5151, Accuracy: 8420/10000 (84.2000%)
___Train Local_Simple,  epoch  47, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2786, Accuracy: 9121/10000 (91.2100%)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3282, Accuracy: 8967/10000 (89.6700%)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 560/600 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4491, Accuracy: 8558/10000 (85.5800%)
___Train Local_Simple,  epoch  47, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4500, Accuracy: 8374/10000 (83.7400%)
___Train Local_Simple,  epoch  47, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2970, Accuracy: 9130/10000 (91.3000%)
___Train Local_Simple,  epoch  47, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3156, Accuracy: 9059/10000 (90.5900%)
___Train Local_Simple,  epoch  47, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5158, Accuracy: 8344/10000 (83.4400%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  47, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 534/600 (89.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2663, Accuracy: 9234/10000 (92.3400%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  47, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 552/600 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2778, Accuracy: 9110/10000 (91.1000%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0030, Accuracy: 567/600 (94.5000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3915, Accuracy: 8844/10000 (88.4400%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6547, Accuracy: 8291/10000 (82.9100%)
time spent on training: 29.624468088150024
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.1966, Accuracy: 9434/10000 (94.3400%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 7.6492, Accuracy: 70/8968 (0.7806%)
[Epoch 47] Backdoor Accuracy (combine): 70/8968 (0.78%)
Done in 39.53346490859985 sec.
Server Epoch:48 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  48, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7907, Accuracy: 7978/10000 (79.7800%)
___Train Local_Simple,  epoch  48, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 563/600 (93.8333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4554, Accuracy: 8507/10000 (85.0700%)
___Train Local_Simple,  epoch  48, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4872, Accuracy: 8362/10000 (83.6200%)
___Train Local_Simple,  epoch  48, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4065, Accuracy: 8722/10000 (87.2200%)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4071, Accuracy: 8684/10000 (86.8400%)
___Train Local_Simple,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4007, Accuracy: 8682/10000 (86.8200%)
___Train Local_Simple,  epoch  48, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4118, Accuracy: 8681/10000 (86.8100%)
___Train Local_Simple,  epoch  48, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2822, Accuracy: 9110/10000 (91.1000%)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 564/600 (94.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5065, Accuracy: 8408/10000 (84.0800%)
___Train Local_Simple,  epoch  48, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 547/600 (91.1667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4046, Accuracy: 8719/10000 (87.1900%)
___Train Local_Simple,  epoch  48, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3180, Accuracy: 8940/10000 (89.4000%)
___Train Local_Simple,  epoch  48, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3828, Accuracy: 8733/10000 (87.3300%)
___Train Local_Simple,  epoch  48, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2994, Accuracy: 9112/10000 (91.1200%)
___Train Local_Simple,  epoch  48, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 560/600 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4645, Accuracy: 8672/10000 (86.7200%)
___Train Local_Simple,  epoch  48, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 553/600 (92.1667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3316, Accuracy: 8917/10000 (89.1700%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3769, Accuracy: 8857/10000 (88.5700%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  48, local model 1, internal_epoch   1,  Average loss: 0.0050, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3135, Accuracy: 9014/10000 (90.1400%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3365, Accuracy: 8907/10000 (89.0700%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  48, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 572/600 (95.3333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2960, Accuracy: 9106/10000 (91.0600%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 562/600 (93.6667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4554, Accuracy: 8518/10000 (85.1800%)
time spent on training: 31.000207901000977
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.1929, Accuracy: 9441/10000 (94.4100%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 7.6689, Accuracy: 69/8968 (0.7694%)
[Epoch 48] Backdoor Accuracy (combine): 69/8968 (0.77%)
Done in 41.25670671463013 sec.
Server Epoch:49 choose agents : [0, 2, 5, 6, 11, 12, 15, 16, 17, 18, 8, 10, 13, 14, 3, 19, 1, 4, 7, 9].
___Train Local_Simple,  epoch  49, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6225, Accuracy: 8190/10000 (81.9000%)
___Train Local_Simple,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3323, Accuracy: 8987/10000 (89.8700%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3960, Accuracy: 8679/10000 (86.7900%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 541/600 (90.1667%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5582, Accuracy: 8219/10000 (82.1900%)
___Train Local_Simple,  epoch  49, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 556/600 (92.6667%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4663, Accuracy: 8517/10000 (85.1700%)
___Train Local_Simple,  epoch  49, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3923, Accuracy: 8885/10000 (88.8500%)
___Train Local_Simple,  epoch  49, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5117, Accuracy: 8309/10000 (83.0900%)
___Train Local_Simple,  epoch  49, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3264, Accuracy: 8975/10000 (89.7500%)
___Train Local_Simple,  epoch  49, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 566/600 (94.3333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3109, Accuracy: 9021/10000 (90.2100%)
___Train Local_Simple,  epoch  49, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 548/600 (91.3333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3993, Accuracy: 8755/10000 (87.5500%)
___Train Local_Simple,  epoch  49, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 549/600 (91.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4417, Accuracy: 8595/10000 (85.9500%)
___Train Local_Simple,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 565/600 (94.1667%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5364, Accuracy: 8312/10000 (83.1200%)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 557/600 (92.8333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4114, Accuracy: 8694/10000 (86.9400%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3377, Accuracy: 9025/10000 (90.2500%)
___Train Local_Simple,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 540/600 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4744, Accuracy: 8435/10000 (84.3500%)
___Train Local_Simple,  epoch  49, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6195, Accuracy: 7978/10000 (79.7800%)
poison local model 1 index 0 
___Train Local_Simple,  epoch  49, local model 1, internal_epoch   1,  Average loss: 0.0050, Accuracy: 546/600 (91.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3896, Accuracy: 8838/10000 (88.3800%)
poison local model 4 index 1 
___Train Local_Simple,  epoch  49, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6520, Accuracy: 7865/10000 (78.6500%)
poison local model 7 index 2 
___Train Local_Simple,  epoch  49, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2755, Accuracy: 9118/10000 (91.1800%)
poison local model 9 index 3 
___Train Local_Simple,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 567/600 (94.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5433, Accuracy: 8276/10000 (82.7600%)
time spent on training: 35.30956983566284
Counter({np.int64(0): 20}) 2
[]
lengthof agents: 20
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.1889, Accuracy: 9451/10000 (94.5100%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 7.6484, Accuracy: 69/8968 (0.7694%)
[Epoch 49] Backdoor Accuracy (combine): 69/8968 (0.77%)